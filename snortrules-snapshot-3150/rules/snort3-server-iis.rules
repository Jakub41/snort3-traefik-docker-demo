# Copyright 2001-2012 Sourcefire Inc. All Rights Reserved.
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright  Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002- Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#------------
# SERVER-IIS
#------------
# fast_pattern's 'only' option has been deleted
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS FastCGI request header buffer overflow attempt"; flow:to_server,established; http_header; content:"aaa: aa|0D 0A|aab: aa|0D 0A|aac: aa|0D 0A|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,43138; reference:cve,2010-2730; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-065; classtype:attempted-admin; sid:24380; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS FastCGI request header buffer overflow attempt"; flow:to_server,established; content:"HTTP/1.",fast_pattern,nocase; http_header; pcre:"/(^[^\r\n]+?\r?\n){16}/m"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,43138; reference:cve,2010-2730; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-065; classtype:attempted-admin; sid:24379; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS stack exhaustion DoS attempt"; flow:to_server,established; http_method; content:"HEAD",nocase; pkt_data; content:"|0D 0A 0D 0A|",distance 0; pcre:"/^(?P<p1>\w+)=(?P<v1>\w+)\&((?P=p1)=(?P=v1)\&){15}/R"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,43140; reference:cve,2010-1899; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-065; classtype:attempted-dos; sid:24276; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS stack exhaustion DoS attempt"; flow:to_server,established; http_client_body; content:"Q=M&Q=M&Q=M&Q=M&Q=M&",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,43140; reference:cve,2010-1899; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-065; classtype:attempted-dos; sid:24275; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS stack exhaustion DoS attempt"; flow:to_server,established; http_client_body; content:"C=A&C=A&C=A&C=A&C=A&",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,43140; reference:cve,2010-1899; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-065; classtype:attempted-dos; sid:24274; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 443 ( msg:"SERVER-IIS Microsoft Windows IIS SChannel improper certificate verification"; flow:to_server,established; ssl_state:client_keyx; content:"|1D 1D 55 69 8B 83 B2 CF 4A 71 6F A1 45 62 8C 7C BD 98 79 15 E5 85 EB 87 5B FC 06 04 D7 14 03 01 00 01 01 16 03|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ssl; reference:cve,2009-0085; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-007; classtype:misc-activity; sid:17431; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft XML parser IIS WebDAV attack attempt"; flow:established,to_server; content:"PROPFIND",depth 8,nocase; pcre:"/(xmlns\x3A.*?){15}/"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,11384; reference:cve,2003-0718; classtype:denial-of-service; sid:12043; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"SERVER-IIS Microsoft IIS 7.5 client verify null pointer attempt"; flow:established,to_server; ssl_state:client_keyx; ssl_version:tls1.0; content:"|16 03 01|",depth 3; content:"|10|",within 1,distance 2; byte_jump:2,-3,relative; content:"|16 03 01|",within 3; content:"|0F|",within 1,distance 2; metadata:policy max-detect-ips drop; reference:cve,2010-3229; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-085; classtype:attempted-dos; sid:17750; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS malformed URL .dll denial of service attempt"; flow:to_server,established; http_uri; content:".dll/"; content:"/~",within 10,distance -1; pcre:"/\.dll\/.{0,10}\x7e\d/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,15921; reference:cve,2005-4360; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-041; classtype:attempted-dos; sid:16147; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS 5.0 WebDav Request Directory Security Bypass"; flow:to_server,established; content:"POST",nocase; content:"|25 32 35 25 33 37 25 33 30 25 32 35 25 33 37 25|",within 16,distance 2; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,35232; reference:cve,2009-1122; classtype:attempted-admin; sid:17525; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"SERVER-IIS Microsoft Windows 7 IIS7.5 FTPSVC buffer overflow attempt"; flow:to_server,established; content:"|BF FF EF EF BB BF FE FF EF BB BF FF EF FF EF EF BB BF EF BB|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp; reference:bugtraq,45542; reference:cve,2010-3972; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-004; classtype:attempted-admin; sid:18243; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS FastCGI request header buffer overflow attempt"; flow:to_server,established; http_header; content:"poc1: poc|0D 0A|poc2: poc|0D 0A|poc3: poc",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,43138; reference:cve,2010-2730; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-065; classtype:attempted-admin; sid:19183; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS stack exhaustion DoS attempt"; flow:to_server,established; http_client_body; content:"p=1&p=1&p=1&p=1&p=1&",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,43140; reference:cve,2010-1899; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-065; classtype:attempted-dos; sid:19192; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS RSA Authentication Agent chunked HTTP request buffer overflow attempt"; flow:to_server,established; http_uri; content:"IISWebAgentIF.dll",fast_pattern,nocase; content:"Redirect",nocase; content:"url=",distance 0,nocase; pcre:"/IISWebAgentIF\.dll[^\n]*?Redirect[^\n]*?[?&]url=[^\n&]{256}/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,26424; reference:cve,2005-1471; reference:cve,2005-4734; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=9192; classtype:web-application-attack; sid:17440; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS source code disclosure attempt"; flow:to_server,established; http_uri; content:".asp",nocase; pcre:"/\x2easp([\?\x5c\x2f]|$)/smi"; http_header; content:"host",nocase; content:"localhost",nocase; pcre:"/^Host\s*\x3A\s*localhost\s/mi"; metadata:policy max-detect-ips drop; service:http; reference:cve,2005-2678; reference:url,secunia.com/advisories/16548; classtype:misc-attack; sid:17653; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS source code disclosure attempt"; flow:to_server,established; http_uri; content:"http|3A 2F|localhost",depth 16,nocase; http_header; content:"Host: localhost",nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2005-2678; reference:url,secunia.com/advisories/16548; classtype:misc-attack; sid:17652; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS stack exhaustion DoS attempt"; flow:to_server,established; http_client_body; content:"id=1&id=1&id=1&id=1&id=1&",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2010-1899; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-065; classtype:attempted-dos; sid:17254; rev:12; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS cmd.exe access"; flow:to_server,established; http_client_body; content:"cmd.exe",fast_pattern,nocase; pcre:"/\bcmd\x2eexe\b/is"; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:23626; rev:10; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS tilde character file name discovery attempt"; flow:to_server,established; http_uri; content:"~1.",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:url,soroush.secproject.com/blog/2012/06/microsoft-iis-tilde-character-vulnerabilityfeature-short-filefolder-name-disclosure/; classtype:attempted-recon; sid:23362; rev:4; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS tilde character file name discovery attempt"; flow:to_server,established; content:"%3f%3f",fast_pattern,nocase; http_raw_uri; content:"%3f%3f"; metadata:policy max-detect-ips drop; service:http; reference:url,soroush.secproject.com/blog/2012/06/microsoft-iis-tilde-character-vulnerabilityfeature-short-filefolder-name-disclosure/; classtype:attempted-recon; sid:23361; rev:5; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS tilde character file name discovery attempt"; flow:to_server,established,only_stream; http_uri; content:"~1"; content:"?aspxerrorpath=/",distance 0; detection_filter:track by_src, count 10, seconds 5; metadata:policy max-detect-ips drop; service:http; reference:url,soroush.secproject.com/blog/2012/06/microsoft-iis-tilde-character-vulnerabilityfeature-short-filefolder-name-disclosure/; classtype:attempted-recon; sid:23360; rev:5; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS 6 multiple executable extension access attempt"; flow:to_server,established; http_uri; content:"|2E|php|3B|",fast_pattern,nocase; pcre:"/\x2ephp\x3b[^\x3f\x3b]*\x2e(bmp|jpg|gif|txt|png|pdf|htm)/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,37460; reference:cve,2009-4444; reference:url,blogs.technet.com/msrc/archive/2009/12/27/new-reports-of-a-vulnerability-in-iis.aspx; classtype:web-application-attack; sid:21606; rev:7; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS 6 multiple executable extension access attempt"; flow:to_server,established; http_uri; content:"|2E|stm|3B|",fast_pattern,nocase; pcre:"/\x2estm\x3b[^\x3f\x3b]*\x2e(bmp|jpg|gif|txt|png|pdf|htm)/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,37460; reference:cve,2009-4444; reference:url,blogs.technet.com/msrc/archive/2009/12/27/new-reports-of-a-vulnerability-in-iis.aspx; classtype:web-application-attack; sid:21605; rev:7; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS 6 multiple executable extension access attempt"; flow:to_server,established; http_uri; content:"|2E|shtml|3B|",fast_pattern,nocase; pcre:"/\x2eshtml\x3b[^\x3f\x3b]*\x2e(bmp|jpg|gif|txt|png|pdf|htm)/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,37460; reference:cve,2009-4444; reference:url,blogs.technet.com/msrc/archive/2009/12/27/new-reports-of-a-vulnerability-in-iis.aspx; classtype:web-application-attack; sid:21604; rev:7; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS 6 multiple executable extension access attempt"; flow:to_server,established; http_uri; content:"|2E|shtm|3B|",fast_pattern,nocase; pcre:"/\x2eshtm\x3b[^\x3f\x3b]*\x2e(bmp|jpg|gif|txt|png|pdf|htm)/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,37460; reference:cve,2009-4444; reference:url,blogs.technet.com/msrc/archive/2009/12/27/new-reports-of-a-vulnerability-in-iis.aspx; classtype:web-application-attack; sid:21603; rev:7; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS 6 multiple executable extension access attempt"; flow:to_server,established; http_uri; content:"|2E|cer|3B|",fast_pattern,nocase; pcre:"/\x2ecer\x3b[^\x3f\x3b]*\x2e(bmp|jpg|gif|txt|png|pdf|htm)/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,37460; reference:cve,2009-4444; reference:url,blogs.technet.com/msrc/archive/2009/12/27/new-reports-of-a-vulnerability-in-iis.aspx; classtype:web-application-attack; sid:21602; rev:7; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS 6 multiple executable extension access attempt"; flow:to_server,established; http_uri; content:"|2E|cdx|3B|",fast_pattern,nocase; pcre:"/\x2ecdx\x3b[^\x3f\x3b]*\x2e(bmp|jpg|gif|txt|png|pdf|htm)/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,37460; reference:cve,2009-4444; reference:url,blogs.technet.com/msrc/archive/2009/12/27/new-reports-of-a-vulnerability-in-iis.aspx; classtype:web-application-attack; sid:21601; rev:7; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS 6 multiple executable extension access attempt"; flow:to_server,established; http_uri; content:"|2E|asp|3B|",fast_pattern,nocase; pcre:"/\x2easp\x3b[^\x3f\x3b]*\x2e(bmp|jpg|gif|txt|png|pdf|htm)/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,37460; reference:cve,2009-4444; reference:url,blogs.technet.com/msrc/archive/2009/12/27/new-reports-of-a-vulnerability-in-iis.aspx; classtype:web-application-attack; sid:21600; rev:7; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS 6 multiple executable extension access attempt"; flow:to_server,established; http_uri; content:"|2E|asa|3B|",fast_pattern,nocase; pcre:"/\x2easa\x3b[^\x3f\x3b]*\x2e(bmp|jpg|gif|txt|png|pdf|htm)/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,37460; reference:cve,2009-4444; reference:url,blogs.technet.com/msrc/archive/2009/12/27/new-reports-of-a-vulnerability-in-iis.aspx; classtype:web-application-attack; sid:21599; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS5 NTLM and basic authentication bypass attempt"; flow:to_server,established; http_uri; content:"/null.htw",nocase; content:"CiWebhitsfile=",nocase; pcre:"/null\.htw[^$]*?[\x3f\x26]CiWebhitsfile=[^\x26]+\x26/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,24105; reference:cve,2007-2815; reference:url,support.microsoft.com/kb/328832; classtype:attempted-user; sid:21161; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS .NET null character username truncation attempt"; flow:to_server,established; http_client_body; content:"CreateUserStepContainer|25|24",fast_pattern,nocase; pcre:"/(^|\x26|\x24|%24|%26)User[^\x3D]*\x3D[^\x26]+(\x00|%00)/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-3416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-100; classtype:suspicious-login; sid:20829; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS aspx login ReturnURL arbitrary redirect attempt"; flow:to_server,established; http_uri; content:"ReturnURL=http:/",nocase; pkt_data; pcre:"/ReturnURL=http\x3a\x2f\x2f[^\r\n\x26]+(\x5c|%5C)[\s\x26]/si"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-3415; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-100; classtype:web-application-attack; sid:20828; rev:10; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"SERVER-IIS Microsoft Active Directory Federation Services code execution attempt"; flow:to_client,established; http_header; content:"pFilterCtxHdr",nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2009-2509; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-070; reference:url,www.securityfocus.com/bid/37214; classtype:web-application-attack; sid:20675; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS UNC mapped virtual host file source code access attempt"; flow:to_server,established; http_raw_uri; content:"htr|5C|",nocase; pcre:"/htr\x5C$/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,1081; reference:cve,2000-0246; reference:url,technet.microsoft.com/en-us/security/bulletin/MS00-019; classtype:attempted-recon; sid:20665; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS UNC mapped virtual host file source code access attempt"; flow:to_server,established; http_raw_uri; content:"asp|5C|",nocase; pcre:"/asp\x5C$/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,1081; reference:cve,2000-0246; reference:url,technet.microsoft.com/en-us/security/bulletin/MS00-019; classtype:attempted-recon; sid:20664; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS ADFS custom header arbitrary code execution attempt "; flow:to_server,established; http_header; content:"pFilterCtxHdr",nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2009-2509; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-070; classtype:attempted-admin; sid:16312; rev:6; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Office FrontPage server extensions 2002 cross site scripting attempt"; flow:to_server,established; http_uri; content:"_vti_bin/_vti_adm/fpadmdll.dll",fast_pattern,nocase; http_client_body; content:"name=",nocase; pcre:"/name\x3D[^\x26]*?(\x2D|\x252D){2}(\x3E|\x253E)/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,17452; reference:cve,2006-0015; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-017; classtype:attempted-user; sid:7029; rev:19; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Office FrontPage server extensions 2002 cross site scripting attempt"; flow:to_server,established; http_uri; content:"_vti_bin/_vti_adm/fpadmdll.dll",fast_pattern,nocase; http_client_body; content:"command=",nocase; pcre:"/command\x3D[^\x26]*?(\x2D|\x252D){2}(\x3E|\x253E)/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,17452; reference:cve,2006-0015; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-017; classtype:attempted-user; sid:7028; rev:19; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Office FrontPage server extensions 2002 cross site scripting attempt"; flow:to_server,established; http_uri; content:"_vti_bin/_vti_adm/fpadmdll.dll",fast_pattern,nocase; http_client_body; content:"operation=",nocase; pcre:"/operation\x3D[^\x26]*?(\x2D|\x252D){2}(\x3E|\x253E)/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,17452; reference:cve,2006-0015; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-017; classtype:attempted-user; sid:7027; rev:20; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS RSA Authentication Agent chunked HTTP request buffer overflow attempt"; flow:to_server,established; http_uri; content:"/WebID/IISWebAgentIF.dll",fast_pattern,nocase; http_header; content:"Transfer-Encoding|3A| chunked",nocase; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,13524; reference:cve,2005-1471; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=9192; classtype:web-application-attack; sid:17705; rev:11; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS source code disclosure attempt"; flow:to_server,established; content:"Translate|3A| ",nocase; byte_test:1,=,102,0,relative; http_raw_uri; pcre:"/%.*%/smi"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,14764; classtype:attempted-recon; sid:17648; rev:6; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS WebDAV Request Directory Security Bypass attempt"; flow:to_server,established; content:"/%c0%af/"; pcre:"/^(GET|OPTIONS|HEAD|POST|PUT|DELETE|CONNECT|PROPFIND|PROPPATCH|MKCOL|COPY|MOVE|LOCK|UNLOCK)[^\r\n]*\s+[^\r\n]*\x2f\x25c0\x25af\x2f/mi"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,34993; reference:cve,2009-1535; classtype:attempted-admin; sid:17564; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS IIS 5.1 alternate data stream authentication bypass attempt"; flow:to_server,established; http_uri; content:"$i30:$INDEX_ALLOCATION",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2010-2731; reference:cve,2011-4963; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-065; classtype:web-application-attack; sid:17103; rev:16; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS malicious ASP file upload attempt"; flow:to_server,established; http_header; content:"Content-Disposition|3A|",nocase; content:"form-data",within 20,nocase; content:"filename=",nocase; pkt_data; content:"<!--|23|include",distance 0,fast_pattern,nocase; http_header; pcre:"/filename\x3d\x22[^\x22]*asp/smi"; pkt_data; pcre:"/\x3c\x21\x2d\x2d\x23include\s+file\s*=\s*.{250,}-->/smi"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,18858; reference:cve,2006-0026; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-034; classtype:attempted-user; sid:12595; rev:14; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS multiple extension code execution attempt"; flow:to_server,established; http_uri; content:".asp|3B|.",nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2009-4444; classtype:web-application-attack; sid:16356; rev:13; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS w3svc _vti_bin null pointer dereference attempt"; flow:to_server,established; content:"/_vti_bin/.dll/"; http_uri; pcre:"/\/_vti_bin\/\.dll\/(%(0[1-9]|1[0-f])|%3f|\x22|\x2a|\x3a|<|>)[\\\/]~[0-9]/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,15921; reference:cve,2005-4360; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-041; classtype:attempted-dos; sid:12064; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Content Management Server memory corruption"; flow:to_server,established; http_uri; content:"/NR/exeres/",fast_pattern,nocase; content:"frameless"; content:!",frameless"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,22861; reference:cve,2007-0938; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-018; classtype:attempted-user; sid:11191; rev:13; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS ASP.NET 2.0 cross-site scripting attempt"; flow:to_server,established; content:"__LASTFOCUS=",fast_pattern,nocase; pcre:"/__LASTFOCUS=(?!([_a-z]\w*|)([\x26\x3B]|$))/i"; service:http; reference:bugtraq,20337; reference:cve,2006-3436; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-056; classtype:attempted-user; sid:8700; rev:8; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Indexing Service ciRestriction cross-site scripting attempt"; flow:to_server,established; content:"default.idq",nocase; content:"ciRestriction",distance 0,nocase; content:"script",distance 0,nocase; pcre:"/default\.idq[^\r\n]*ciRestriction[^\r\n]*script/smi"; service:http; reference:bugtraq,19927; reference:cve,2006-0032; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-053; classtype:misc-attack; sid:8349; rev:8; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS .bat executable file parsing attack"; flow:to_server,established; http_uri; content:".bat|22|",nocase; pcre:"/\x2ebat\x22.*?\x26/smi"; metadata:ruleset community; service:http; reference:bugtraq,1912; reference:cve,2000-0886; classtype:web-application-attack; sid:3194; rev:16; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS .cmd executable file parsing attack"; flow:to_server,established; http_uri; content:".cmd|22|",nocase; pcre:"/\x2ecmd\x22.*?\x26/smi"; metadata:ruleset community; service:http; reference:bugtraq,1912; reference:cve,2000-0886; classtype:web-application-attack; sid:3193; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS SQLXML content type overflow"; flow:to_server,established; http_uri; pcre:"/\.x[sm]l/i"; content:"contenttype="; pcre:"/contenttype=[^\r\n\x3b\x38]{100}/smi"; metadata:ruleset community; service:http; reference:bugtraq,5004; reference:cve,2002-0186; reference:nessus,11304; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-030; reference:url,www.westpoint.ltd.uk/advisories/wp-02-0007.txt; classtype:attempted-admin; sid:3150; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS w3who.dll buffer overflow attempt"; flow:to_server,established; http_uri; content:"/w3who.dll?",nocase; pkt_data; pcre:"/w3who\.dll\x3F[^\r\n]{519}/i"; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,11820; reference:cve,2004-1134; classtype:attempted-admin; sid:3087; rev:19; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS httpodbc.dll access - nimda"; flow:to_server,established; http_uri; content:"/httpodbc.dll",nocase; metadata:ruleset community; service:http; reference:bugtraq,2708; reference:cve,2001-0333; classtype:web-application-activity; sid:3201; rev:14; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS ping.asp access"; flow:to_server,established; http_uri; content:"/ping.asp",nocase; metadata:ruleset community; service:http; reference:nessus,10968; classtype:web-application-activity; sid:2667; rev:14; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS SmarterTools SmarterMail frmCompose.asp access"; flow:to_server,established; http_uri; content:"/frmCompose.aspx",nocase; metadata:ruleset community; service:http; reference:bugtraq,9805; reference:cve,2004-2585; classtype:web-application-activity; sid:2573; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS SmarterTools SmarterMail login.aspx buffer overflow attempt"; flow:to_server,established; http_uri; content:"/login.aspx",nocase; pkt_data; content:"txtusername="; isdataat:980,relative; content:!"|0A|",within 980,nocase; metadata:ruleset community; service:http; reference:bugtraq,9805; reference:cve,2004-2585; classtype:web-application-attack; sid:2572; rev:12; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS SmarterTools SmarterMail frmGetAttachment.aspx access"; flow:to_server,established; http_uri; content:"/frmGetAttachment.aspx",nocase; metadata:ruleset community; service:http; reference:bugtraq,9805; reference:cve,2004-2585; classtype:web-application-activity; sid:2571; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS NTLM ASN1 vulnerability scan attempt"; flow:to_server,established; http_header; content:"Authorization|3A|",nocase; content:"Negotiate",within 20,nocase; content:"YIQAAABiBoMAAAYrBgEFBQKgggBTMIFQoA4wDAYKKwYBBAGCNwICCqM",within 100; metadata:ruleset community; service:http; reference:bugtraq,9633; reference:bugtraq,9635; reference:cve,2003-0818; reference:nessus,12052; reference:nessus,12055; reference:nessus,12065; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-007; classtype:attempted-dos; sid:2386; rev:23; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS sgdynamo.exe access"; flow:to_server,established; http_uri; content:"/sgdynamo.exe",nocase; metadata:ruleset community; service:http; reference:bugtraq,4720; reference:cve,2002-0375; reference:nessus,11955; classtype:web-application-activity; sid:2326; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS VP-ASP ShopDisplayProducts.asp access"; flow:to_server,established; http_uri; content:"/ShopDisplayProducts.asp",nocase; metadata:ruleset community; service:http; reference:bugtraq,9133; reference:bugtraq,9134; reference:nessus,11942; classtype:web-application-activity; sid:2325; rev:14; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS VP-ASP shopsearch.asp access"; flow:to_server,established; http_uri; content:"/shopsearch.asp",nocase; metadata:ruleset community; service:http; reference:bugtraq,9133; reference:bugtraq,9134; reference:nessus,11942; classtype:web-application-activity; sid:2324; rev:14; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS foxweb.dll access"; flow:to_server,established; http_uri; content:"/foxweb.dll",nocase; metadata:ruleset community; service:http; reference:nessus,11939; classtype:web-application-activity; sid:2322; rev:13; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS foxweb.exe access"; flow:to_server,established; http_uri; content:"/foxweb.exe",nocase; metadata:ruleset community; service:http; reference:nessus,11939; classtype:web-application-activity; sid:2321; rev:13; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS /pcadmin/login.asp access"; flow:to_server,established; http_uri; content:"/pcadmin/login.asp",nocase; metadata:ruleset community; service:http; reference:bugtraq,8103; reference:nessus,11785; classtype:web-application-activity; sid:2249; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS DirectoryListing.asp access"; flow:to_server,established; http_uri; content:"/DirectoryListing.asp",nocase; metadata:ruleset community; service:http; reference:cve,2001-0938; classtype:web-application-activity; sid:2248; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS UploadScript11.asp access"; flow:to_server,established; http_uri; content:"/UploadScript11.asp",nocase; metadata:ruleset community; service:http; reference:bugtraq,3608; reference:cve,2001-0938; reference:nessus,11746; classtype:web-application-activity; sid:2247; rev:16; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS register.asp access"; flow:to_server,established; http_uri; content:"/register.asp",nocase; metadata:ruleset community; service:http; reference:nessus,11621; classtype:web-application-activity; sid:2134; rev:14; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS MS BizTalk server access"; flow:to_server,established; http_uri; content:"/biztalkhttpreceive.dll",nocase; metadata:ruleset community; service:http; reference:bugtraq,7469; reference:bugtraq,7470; reference:cve,2003-0117; reference:cve,2003-0118; reference:nessus,11638; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-016; classtype:web-application-activity; sid:2133; rev:19; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Synchrologic Email Accelerator userid list access attempt"; flow:to_server,established; http_uri; content:"/en/admin/aggregate.asp",nocase; metadata:ruleset community; service:http; reference:nessus,11657; classtype:web-application-activity; sid:2132; rev:14; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS IISProtect access"; flow:to_server,established; http_uri; content:"/iisprotect/admin/",nocase; metadata:ruleset community; service:http; reference:nessus,11661; classtype:web-application-activity; sid:2131; rev:14; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS IISProtect globaladmin.asp access"; flow:to_server,established; http_uri; content:"/iisprotect/admin/GlobalAdmin.asp",nocase; metadata:ruleset community; service:http; reference:nessus,11661; classtype:web-application-activity; sid:2157; rev:14; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS IISProtect siteadmin.asp access"; flow:to_server,established; http_uri; content:"/iisprotect/admin/SiteAdmin.asp",nocase; metadata:ruleset community; service:http; reference:bugtraq,7675; reference:cve,2003-0377; reference:nessus,11662; classtype:web-application-activity; sid:2130; rev:17; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS nsiislog.dll access"; flow:to_server,established; http_uri; content:"/nsiislog.dll",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,8035; reference:cve,2003-0227; reference:cve,2003-0349; reference:nessus,11664; reference:url,technet.microsoft.com/en-us/security/bulletin/ms03-018; classtype:web-application-activity; sid:2129; rev:26; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Battleaxe Forum login.asp access"; flow:to_server,established; http_uri; content:"myaccount/login.asp",nocase; metadata:ruleset community; service:http; reference:bugtraq,7416; reference:cve,2003-0215; reference:nessus,11548; classtype:web-application-activity; sid:2117; rev:18; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS WEBDAV nessus safe scan attempt"; flow:to_server,established; content:"SEARCH / HTTP/1.1|0D 0A|Host|3A|"; content:"|0D 0A 0D 0A|",within 255; metadata:ruleset community; service:http; reference:bugtraq,7116; reference:cve,2003-0109; reference:nessus,11412; reference:nessus,11413; reference:url,technet.microsoft.com/en-us/security/bulletin/ms03-007; classtype:attempted-admin; sid:2091; rev:16; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS WEBDAV exploit attempt"; flow:to_server,established; http_header; content:"HTTP/1.1|0A|Content-type|3A| text/xml|0A|HOST|3A|"; content:"Accept|3A| */*|0A|Translate|3A| f|0A|Content-length|3A|5276|0A 0A|"; metadata:ruleset community; service:http; reference:bugtraq,7116; reference:bugtraq,7716; reference:cve,2003-0109; reference:nessus,11413; reference:url,technet.microsoft.com/en-us/security/bulletin/ms03-007; classtype:attempted-admin; sid:2090; rev:22; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS .cdx HTTP header buffer overflow attempt"; flow:to_server,established; content:"HTTP/",nocase; http_uri; content:".cdx",fast_pattern,nocase; pkt_data; content:"|3A|"; content:"|0A|"; content:"|00|"; metadata:ruleset community; service:http; reference:bugtraq,4476; reference:cve,2002-0150; reference:nessus,10936; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-018; classtype:web-application-attack; sid:1804; rev:21; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS .cer HTTP header buffer overflow attempt"; flow:to_server,established; content:"HTTP/",nocase; http_uri; content:".cer",fast_pattern,nocase; pkt_data; content:"|3A|"; content:"|0A|"; content:"|00|"; metadata:ruleset community; service:http; reference:bugtraq,4476; reference:cve,2002-0150; reference:nessus,10936; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-018; classtype:web-application-attack; sid:1803; rev:21; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS .asa HTTP header buffer overflow attempt"; flow:to_server,established; content:"HTTP/",nocase; http_uri; content:".asa",fast_pattern,nocase; pkt_data; content:"|3A|"; content:"|0A|"; content:"|00|"; metadata:ruleset community; service:http; reference:bugtraq,4476; reference:cve,2002-0150; reference:nessus,10936; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-018; classtype:web-application-attack; sid:1802; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS /exchange/root.asp access"; flow:to_server,established; http_uri; content:"/exchange/root.asp",nocase; metadata:ruleset community; service:http; reference:bugtraq,3301; reference:cve,2001-0660; reference:nessus,10755; reference:nessus,10781; classtype:web-application-activity; sid:1568; rev:23; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS /exchange/root.asp attempt"; flow:to_server,established; http_uri; content:"/exchange/root.asp?",nocase; content:"acs=anon",distance 0,nocase; metadata:ruleset community; service:http; reference:bugtraq,3301; reference:cve,2001-0660; reference:nessus,10755; reference:nessus,10781; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-047; classtype:web-application-attack; sid:1567; rev:26; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS postinfo.asp access"; flow:to_server,established; http_uri; content:"/scripts/postinfo.asp",nocase; metadata:ruleset community; service:http; reference:bugtraq,1811; reference:cve,1999-0360; classtype:web-application-activity; sid:1075; rev:21; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS MS Site Server admin attempt"; flow:to_server,established; http_uri; content:"/Site Server/Admin/knowledge/persmbr/",nocase; metadata:ruleset community; service:http; reference:nessus,11018; classtype:web-application-attack; sid:1818; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS MS Site Server default login attempt"; flow:to_server,established; http_uri; content:"/SiteServer/Admin/knowledge/persmbr/",nocase; pkt_data; pcre:"/^Authorization\x3A\s*Basic\s+TERBUF9Bbm9ueW1vdXM6TGRhcFBhc3N3b3JkXzE=/smi"; metadata:ruleset community; service:http; reference:nessus,11018; reference:url,attack.mitre.org/techniques/T1078; classtype:web-application-attack; sid:1817; rev:19; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS htimage.exe access"; flow:to_server,established; http_uri; content:"/htimage.exe",nocase; metadata:ruleset community; service:http; reference:bugtraq,1117; reference:bugtraq,964; reference:cve,2000-0122; reference:cve,2000-0256; reference:nessus,10376; classtype:web-application-activity; sid:1595; rev:22; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS _mem_bin access"; flow:to_server,established; http_uri; content:"/_mem_bin/",nocase; metadata:ruleset community; service:http; reference:nessus,11032; classtype:web-application-activity; sid:1286; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS msdac access"; flow:to_server,established; http_uri; content:"/msdac/",nocase; metadata:ruleset community; service:http; reference:nessus,11032; classtype:web-application-activity; sid:1285; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS iisadmin access"; flow:to_server,established; http_uri; content:"/iisadmin",nocase; metadata:ruleset community; service:http; reference:bugtraq,189; reference:cve,1999-1538; reference:nessus,11032; classtype:web-application-attack; sid:993; rev:22; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS iissamples access"; flow:to_server,established; http_uri; content:"/iissamples/",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:nessus,11032; classtype:web-application-attack; sid:1402; rev:19; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS /msadc/samples/ access"; flow:to_server,established; http_uri; content:"/msadc/samples/",nocase; metadata:ruleset community; service:http; reference:bugtraq,167; reference:cve,1999-0736; reference:nessus,1007; classtype:web-application-attack; sid:1401; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS /scripts/samples/ access"; flow:to_server,established; http_uri; content:"/scripts/samples/",nocase; metadata:ruleset community; service:http; reference:nessus,10370; classtype:web-application-attack; sid:1400; rev:18; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Office Outlook web dos"; flow:to_server,established; http_uri; content:"/exchange/LogonFrm.asp?",fast_pattern,nocase; pkt_data; content:"mailbox=",nocase; content:"%%%"; metadata:ruleset community; service:http; reference:bugtraq,3223; classtype:web-application-attack; sid:1283; rev:21; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS CodeRed v2 root.exe access"; flow:to_server,established; http_uri; content:"/root.exe",nocase; metadata:ruleset community; service:http; reference:url,www.cert.org/advisories/CA-2001-19.html; classtype:web-application-attack; sid:1256; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS site/iisamples access"; flow:to_server,established; http_uri; content:"/site/iisamples",nocase; metadata:ruleset community; service:http; reference:nessus,10370; classtype:web-application-activity; sid:1046; rev:20; )
alert tcp $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any ( msg:"SERVER-IIS Unauthorized IP Access Attempt"; flow:to_client,established; content:"403"; content:"Forbidden|3A|"; metadata:ruleset community; service:http; classtype:web-application-attack; sid:1045; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS doctodep.btr access"; flow:to_server,established; http_uri; content:"doctodep.btr"; metadata:ruleset community; service:http; classtype:web-application-activity; sid:1726; rev:12; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS webhits access"; flow:to_server,established; http_uri; content:".htw"; metadata:ruleset community; service:http; reference:bugtraq,950; reference:cve,2000-0097; classtype:web-application-activity; sid:1044; rev:17; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS viewcode.asp access"; flow:to_server,established; http_uri; content:"/viewcode.asp",nocase; metadata:ruleset community; service:http; reference:cve,1999-0737; reference:nessus,10576; classtype:web-application-activity; sid:1043; rev:21; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS view source via translate header"; flow:to_server,established; http_header; content:"Translate|3A| F",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,14764; reference:bugtraq,1578; reference:cve,2000-0778; reference:nessus,10491; classtype:web-application-activity; sid:1042; rev:26; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS uploadn.asp access"; flow:to_server,established; http_uri; content:"/scripts/uploadn.asp",nocase; metadata:ruleset community; service:http; reference:bugtraq,1811; reference:cve,1999-0360; classtype:web-application-activity; sid:1041; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS srchadm access"; flow:to_server,established; http_uri; content:"/srchadm",nocase; metadata:ruleset community; service:http; reference:nessus,11032; classtype:web-application-activity; sid:1040; rev:24; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS srch.htm access"; flow:to_server,established; http_uri; content:"/samples/isapi/srch.htm",nocase; metadata:ruleset community; service:http; classtype:web-application-activity; sid:1039; rev:18; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS site server config access"; flow:to_server,established; http_uri; content:"/adsamples/config/site.csc",nocase; metadata:ruleset community; service:http; reference:bugtraq,256; reference:cve,1999-1520; classtype:web-application-activity; sid:1038; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS showcode.asp access"; flow:to_server,established; http_uri; content:"/showcode.asp",nocase; metadata:ruleset community; service:http; reference:bugtraq,167; reference:cve,1999-0736; reference:nessus,10007; reference:url,technet.microsoft.com/en-us/security/bulletin/MS99-013; classtype:web-application-activity; sid:1037; rev:24; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS viewcode access"; flow:to_server,established; http_uri; content:"/Sites/Samples/Knowledge/Search/ViewCode.asp",nocase; metadata:ruleset community; service:http; reference:cve,1999-0737; reference:nessus,10576; reference:url,technet.microsoft.com/en-us/security/bulletin/ms99-013; classtype:web-application-activity; sid:1036; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS viewcode access"; flow:to_server,established; http_uri; content:"/Sites/Samples/Knowledge/Push/ViewCode.asp",nocase; metadata:ruleset community; service:http; reference:cve,1999-0737; reference:nessus,10576; reference:url,technet.microsoft.com/en-us/security/bulletin/ms99-013; classtype:web-application-activity; sid:1035; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS viewcode access"; flow:to_server,established; http_uri; content:"/Sites/Samples/Knowledge/Membership/Inspiredtutorial/ViewCode.asp",nocase; metadata:ruleset community; service:http; reference:cve,1999-0737; reference:nessus,10576; reference:url,technet.microsoft.com/en-us/security/bulletin/ms99-013; classtype:web-application-activity; sid:1034; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS viewcode access"; flow:to_server,established; http_uri; content:"/Sites/Knowledge/Membership/Inspiredtutorial/ViewCode.asp",nocase; metadata:ruleset community; service:http; reference:cve,1999-0737; reference:nessus,10576; reference:url,technet.microsoft.com/en-us/security/bulletin/ms99-013; classtype:web-application-activity; sid:1033; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS showcode access"; flow:to_server,established; http_uri; content:"/Sites/Knowledge/Membership/Inspired/ViewCode.asp",nocase; metadata:ruleset community; service:http; reference:cve,1999-0737; reference:nessus,10576; reference:url,technet.microsoft.com/en-us/security/bulletin/ms99-013; classtype:web-application-activity; sid:1032; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS /SiteServer/Publishing/viewcode.asp access"; flow:to_server,established; http_uri; content:"/SiteServer/Publishing/viewcode.asp",nocase; metadata:ruleset community; service:http; reference:nessus,10576; classtype:web-application-activity; sid:1031; rev:19; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS search97.vts access"; flow:to_server,established; http_uri; content:"/search97.vts"; metadata:ruleset community; service:http; reference:bugtraq,162; classtype:web-application-activity; sid:1030; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS scripts-browse access"; flow:to_server,established; content:"/scripts/ ",fast_pattern,nocase; metadata:ruleset community; service:http; reference:nessus,11032; classtype:web-application-attack; sid:1029; rev:18; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS query.asp access"; flow:to_server,established; http_uri; content:"/issamples/query.asp",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,193; reference:cve,1999-0449; classtype:web-application-activity; sid:1028; rev:22; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS perl-browse space attempt"; flow:to_server,established; http_uri; content:" .pl",nocase; metadata:ruleset community; service:http; reference:bugtraq,6833; reference:cve,2003-1365; classtype:web-application-attack; sid:1027; rev:21; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS perl-browse newline attempt"; flow:to_server,established; http_uri; content:"|0A|.pl",nocase; metadata:ruleset community; service:http; reference:bugtraq,6833; reference:cve,2003-1365; classtype:web-application-attack; sid:1026; rev:22; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS perl access"; flow:to_server,established; http_uri; content:"/scripts/perl",nocase; metadata:ruleset community; service:http; classtype:web-application-activity; sid:1025; rev:18; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS newdsn.exe access"; flow:to_server,established; http_uri; content:"/scripts/tools/newdsn.exe",nocase; metadata:ruleset community; service:http; reference:bugtraq,1818; reference:cve,1999-0191; reference:nessus,10360; classtype:web-application-activity; sid:1024; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS msadcs.dll access"; flow:to_server,established; http_uri; content:"/msadcs.dll",nocase; metadata:ruleset community; service:http; reference:bugtraq,529; reference:cve,1999-1011; reference:nessus,10357; reference:url,technet.microsoft.com/en-us/security/bulletin/ms99-025; classtype:web-application-activity; sid:1023; rev:25; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS jet vba access"; flow:to_server,established; http_uri; content:"/advworks/equipment/catalog_type.asp",nocase; metadata:ruleset community; service:http; reference:bugtraq,286; reference:cve,1999-0874; reference:url,technet.microsoft.com/en-us/security/bulletin/ms99-030; classtype:web-application-activity; sid:1022; rev:22; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS ism.dll attempt"; flow:to_server,established; http_uri; content:" .htr",nocase; pcre:"/\s{230,}\.htr/"; metadata:ruleset community; service:http; reference:bugtraq,1193; reference:cve,2000-0457; reference:nessus,10680; reference:url,technet.microsoft.com/en-us/security/bulletin/MS00-031; classtype:web-application-attack; sid:1021; rev:29; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS isc$data attempt"; flow:to_server,established; http_uri; content:".idc|3A 3A 24|data",nocase; metadata:ruleset community; service:http; reference:bugtraq,307; reference:cve,1999-0874; reference:nessus,10116; classtype:web-application-attack; sid:1020; rev:26; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Malformed Hit-Highlighting Argument File Access Attempt"; flow:to_server,established; http_uri; content:"CiWebHitsFile=",nocase; pkt_data; pcre:"/CiWebHitsFile=\/?([^\r\n\x3b\&]*\.\.\/)?/i"; http_uri; content:"CiRestriction=none",fast_pattern,nocase; content:"ciHiliteType=Full",nocase; metadata:ruleset community; service:http; reference:bugtraq,950; reference:cve,2000-0097; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-006; reference:url,www.securityfocus.com/archive/1/43762; classtype:web-application-attack; sid:1019; rev:30; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS iisadmpwd attempt"; flow:to_server,established; http_uri; content:"/iisadmpwd/aexp",nocase; metadata:ruleset community; service:http; reference:bugtraq,2110; reference:cve,1999-0407; reference:nessus,10371; classtype:web-application-attack; sid:1018; rev:23; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS idc-srch attempt"; flow:to_server,established; content:"|23|filename=*.idc",fast_pattern,nocase; metadata:ruleset community; service:http; reference:cve,1999-0874; classtype:web-application-attack; sid:1017; rev:18; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS global.asa access"; flow:to_server,established; http_uri; content:"/global.asa",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:cve,2000-0778; reference:cve,2001-0004; reference:nessus,10491; reference:nessus,10991; reference:url,technet.microsoft.com/en-us/security/bulletin/ms01-004; classtype:web-application-activity; sid:1016; rev:26; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS getdrvs.exe access"; flow:to_server,established; http_uri; content:"/scripts/tools/getdrvs.exe",nocase; metadata:ruleset community; service:http; classtype:web-application-activity; sid:1015; rev:18; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS fpcount access"; flow:to_server,established; http_uri; content:"/fpcount.exe",nocase; metadata:ruleset community; service:http; reference:bugtraq,2252; reference:cve,1999-1376; classtype:web-application-activity; sid:1013; rev:21; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS fpcount attempt"; flow:to_server,established; http_uri; content:"/fpcount.exe",fast_pattern,nocase; pkt_data; content:"Digits=",nocase; metadata:ruleset community; service:http; reference:bugtraq,2252; reference:cve,1999-1376; classtype:web-application-attack; sid:1012; rev:21; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS exec-src access"; flow:to_server,established; content:"|23|filename=*.exe",fast_pattern,nocase; metadata:ruleset community; service:http; classtype:web-application-activity; sid:1011; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS encoding access"; flow:to_server,established; content:"%1u",fast_pattern,nocase; metadata:ruleset community; service:http; reference:bugtraq,886; reference:cve,2000-0024; reference:url,technet.microsoft.com/en-us/security/bulletin/MS99-061; classtype:web-application-activity; sid:1010; rev:21; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS directory listing"; flow:to_server,established; http_uri; content:"/ServerVariables_Jscript.asp",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:nessus,10573; classtype:web-application-attack; sid:1009; rev:19; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS del attempt"; flow:to_server,established; content:"&del+/s+c|3A 5C|*.*",fast_pattern,nocase; metadata:ruleset community; service:http; classtype:web-application-attack; sid:1008; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Form_VBScript.asp access"; flow:to_server,established; http_uri; content:"/Form_VBScript.asp",nocase; metadata:ruleset community; service:http; reference:bugtraq,1594; reference:bugtraq,1595; reference:cve,2000-0746; reference:cve,2000-1104; reference:nessus,10572; reference:url,technet.microsoft.com/en-us/security/bulletin/MS00-060; classtype:web-application-attack; sid:1380; rev:21; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Form_JScript.asp access"; flow:to_server,established; http_uri; content:"/Form_JScript.asp",nocase; metadata:ruleset community; service:http; reference:bugtraq,1594; reference:bugtraq,1595; reference:cve,2000-0746; reference:cve,2000-1104; reference:nessus,10572; reference:url,technet.microsoft.com/en-us/security/bulletin/MS00-028; reference:url,technet.microsoft.com/en-us/security/bulletin/MS00-060; classtype:web-application-attack; sid:1007; rev:24; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS codebrowser SDK access"; flow:to_server,established; http_uri; content:"/iissamples/sdk/asp/docs/codebrws.asp",nocase; metadata:ruleset community; service:http; reference:bugtraq,167; reference:cve,1999-0736; classtype:web-application-activity; sid:1005; rev:23; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS codebrowser Exair access"; flow:to_server,established; http_uri; content:"/iissamples/exair/howitworks/codebrws.asp",nocase; metadata:ruleset community; service:http; reference:cve,1999-0499; reference:cve,1999-0815; classtype:web-application-activity; sid:1004; rev:19; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS cmd? access"; flow:to_server,established; content:".cmd?&",fast_pattern,nocase; metadata:ruleset community; service:http; classtype:web-application-attack; sid:1003; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS cmd.exe access"; flow:to_server,established; http_uri; content:"cmd.exe",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-attack; sid:1002; rev:19; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS cmd32.exe access"; flow:to_server,established; http_uri; content:"cmd32.exe",nocase; metadata:ruleset community; service:http; classtype:web-application-attack; sid:1661; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS bdir.htr access"; flow:to_server,established; http_uri; content:"/bdir.htr",nocase; metadata:ruleset community; service:http; reference:bugtraq,2280; reference:nessus,10577; classtype:web-application-activity; sid:1000; rev:23; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS bdir access"; flow:to_server,established; http_uri; content:"/scripts/iisadmin/bdir.htr",nocase; metadata:ruleset community; service:http; reference:bugtraq,2280; classtype:web-application-activity; sid:999; rev:19; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS asp-srch attempt"; flow:to_server,established; http_uri; content:"|23|filename=*.asp",nocase; metadata:ruleset community; service:http; classtype:web-application-attack; sid:998; rev:19; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS asp-dot attempt"; flow:to_server,established; http_uri; content:".asp.",nocase; metadata:ruleset community; service:http; reference:bugtraq,1814; reference:nessus,10363; classtype:web-application-attack; sid:997; rev:21; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS anot.htr access"; flow:to_server,established; http_uri; content:"/iisadmpwd/anot",nocase; metadata:ruleset community; service:http; reference:bugtraq,2110; reference:cve,1999-0407; classtype:web-application-activity; sid:996; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS ism.dll access"; flow:to_server,established; http_uri; content:"/scripts/iisadmin/ism.dll?http/dir",nocase; metadata:ruleset community; service:http; reference:bugtraq,189; reference:cve,1999-1538; reference:cve,2000-0630; classtype:web-application-attack; sid:995; rev:26; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS /scripts/iisadmin/default.htm access"; flow:to_server,established; http_uri; content:"/scripts/iisadmin/default.htm",nocase; metadata:ruleset community; service:http; classtype:web-application-attack; sid:994; rev:19; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS adctest.asp access"; flow:to_server,established; http_uri; content:"/msadc/samples/adctest.asp",nocase; metadata:ruleset community; service:http; classtype:web-application-activity; sid:992; rev:17; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS achg.htr access"; flow:to_server,established; http_uri; content:"/iisadmpwd/achg.htr",nocase; metadata:ruleset community; service:http; reference:bugtraq,2110; reference:cve,1999-0407; classtype:web-application-activity; sid:991; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS +.htr code fragment attempt"; flow:to_server,established; http_uri; content:" .htr",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,1488; reference:cve,2000-0630; reference:cve,2001-0004; reference:nessus,10680; reference:url,technet.microsoft.com/en-us/security/bulletin/MS00-044; reference:url,technet.microsoft.com/en-us/security/bulletin/ms01-004; classtype:web-application-attack; sid:1725; rev:25; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS MSProxy access"; flow:to_server,established; http_uri; content:"/scripts/proxy/w3proxy.dll",nocase; metadata:ruleset community; service:http; reference:url,support.microsoft.com/?kbid=331066; classtype:web-application-activity; sid:986; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS JET VBA access"; flow:to_server,established; http_uri; content:"/scripts/samples/details.idc",nocase; metadata:ruleset community; service:http; reference:bugtraq,286; reference:cve,1999-0874; classtype:web-application-activity; sid:985; rev:22; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS JET VBA access"; flow:to_server,established; http_uri; content:"/scripts/samples/ctguestb.idc",nocase; metadata:ruleset community; service:http; reference:bugtraq,307; reference:cve,1999-0874; reference:nessus,10116; classtype:web-application-activity; sid:984; rev:25; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS CGImail.exe access"; flow:to_server,established; http_uri; content:"/scripts/CGImail.exe",nocase; metadata:ruleset community; service:http; reference:bugtraq,1623; reference:cve,2000-0726; reference:nessus,11721; classtype:web-application-activity; sid:980; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS ASP contents view"; flow:to_server,established; http_uri; content:".htw?CiWebHitsFile",fast_pattern,nocase; metadata:ruleset community; service:http; reference:bugtraq,1861; reference:cve,2000-0942; reference:url,technet.microsoft.com/en-us/security/bulletin/MS00-006; classtype:web-application-attack; sid:979; rev:22; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS ASP contents view"; flow:to_server,established; content:"%20"; content:"&CiRestriction=none",nocase; content:"&CiHiliteType=Full",fast_pattern,nocase; metadata:ruleset community; service:http; reference:bugtraq,1084; reference:cve,2000-0302; reference:nessus,10356; reference:url,technet.microsoft.com/en-us/security/bulletin/MS00-006; classtype:web-application-attack; sid:978; rev:21; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS .cnf access"; flow:to_server,established; http_uri; content:".cnf",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,4078; reference:cve,2002-1717; reference:nessus,10575; classtype:web-application-activity; sid:977; rev:25; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Alternate Data streams ASP file access attempt"; flow:to_server,established; http_uri; content:".asp|3A 3A 24|DATA",nocase; metadata:ruleset community; service:http; reference:bugtraq,149; reference:cve,1999-0278; reference:nessus,10362; reference:url,docs.microsoft.com/en-us/security-updates/securitybulletins/1998/ms98-003; classtype:web-application-attack; sid:975; rev:27; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS directory traversal attempt"; flow:to_server,established; content:"..|5C|..",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,2218; reference:cve,1999-0229; classtype:web-application-attack; sid:974; rev:23; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS *.idc attempt"; flow:to_server,established; http_uri; content:"/*.idc",nocase; metadata:ruleset community; service:http; reference:bugtraq,1448; reference:cve,1999-0874; reference:cve,2000-0661; classtype:web-application-attack; sid:973; rev:24; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS ISAPI .idq access"; flow:to_server,established; http_uri; content:".idq",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,1065; reference:cve,2000-0071; classtype:web-application-activity; sid:1245; rev:24; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS ISAPI .idq attempt"; flow:to_server,established; http_uri; content:".idq?",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,1065; reference:bugtraq,968; reference:cve,2000-0071; reference:cve,2000-0126; reference:cve,2001-0500; reference:nessus,10115; classtype:web-application-attack; sid:1244; rev:29; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS ISAPI .ida access"; flow:to_server,established; http_uri; content:".ida",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,1065; reference:cve,2000-0071; classtype:web-application-activity; sid:1242; rev:24; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS ISAPI .ida attempt"; flow:to_server,established; http_uri; content:".ida?",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,1065; reference:cve,2000-0071; reference:cve,2001-0500; classtype:web-application-attack; sid:1243; rev:26; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS ISAPI .printer access"; flow:to_server,established; http_uri; content:".printer",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,2674; reference:cve,2001-0241; reference:nessus,10661; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-023; classtype:web-application-activity; sid:971; rev:28; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS WebDAV file lock attempt"; flow:to_server,established; content:"LOCK ",depth 5; metadata:ruleset community; service:http; reference:bugtraq,2736; reference:nessus,10732; classtype:web-application-activity; sid:969; rev:13; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS /iisadmpwd/aexp2.htr access"; flow:to_server,established; http_uri; content:"/iisadmpwd/aexp2.htr",nocase; metadata:ruleset community; service:http; reference:bugtraq,2110; reference:bugtraq,4236; reference:cve,1999-0407; reference:cve,2002-0421; reference:nessus,10371; classtype:web-application-activity; sid:1487; rev:22; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS ctss.idc access"; flow:to_server,established; http_uri; content:"/ctss.idc",nocase; metadata:ruleset community; service:http; reference:nessus,10359; classtype:web-application-activity; sid:1486; rev:18; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS mkilog.exe access"; flow:to_server,established; http_uri; content:"/mkilog.exe",nocase; metadata:ruleset community; service:http; reference:nessus,10359; classtype:web-application-activity; sid:1485; rev:21; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS trace.axd access"; flow:to_server,established; http_uri; content:"/trace.axd",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:nessus,10993; classtype:web-application-activity; sid:1660; rev:19; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS pbserver access"; flow:to_server,established; http_uri; content:"/pbserver/pbserver.dll",nocase; metadata:ruleset community; service:http; reference:cve,2000-1089; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-094; classtype:web-application-activity; sid:1772; rev:18; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS NewsPro administration authentication attempt"; flow:to_server,established; content:"logged,true"; metadata:ruleset community; service:http; reference:bugtraq,4672; reference:cve,2002-1734; classtype:web-application-activity; sid:1756; rev:12; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS as_web4.exe access"; flow:to_server,established; http_uri; content:"/as_web4.exe",nocase; metadata:ruleset community; service:http; reference:bugtraq,4670; reference:cve,2002-1727; reference:cve,2002-1728; classtype:web-application-activity; sid:1754; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS as_web.exe access"; flow:to_server,established; http_uri; content:"/as_web.exe",nocase; metadata:ruleset community; service:http; reference:bugtraq,4670; reference:cve,2002-1727; reference:cve,2002-1728; classtype:web-application-activity; sid:1753; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS users.xml access"; flow:to_server,established; http_uri; content:"/users.xml",nocase; metadata:ruleset community; service:http; classtype:web-application-activity; sid:1750; rev:15; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS /StoreCSVS/InstantOrder.asmx request"; flow:to_server,established; http_uri; content:"/StoreCSVS/InstantOrder.asmx",nocase; metadata:ruleset community; service:http; classtype:web-application-activity; sid:1626; rev:16; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS .asp chunked Transfer-Encoding"; flow:to_server,established; http_uri; content:".asp",nocase; http_header; content:"Transfer-Encoding|3A|",nocase; content:"chunked",nocase; metadata:ruleset community; service:http; reference:bugtraq,4474; reference:bugtraq,4485; reference:cve,2002-0071; reference:cve,2002-0079; reference:nessus,10932; classtype:web-application-attack; sid:1618; rev:26; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS .htr chunked Transfer-Encoding"; flow:to_server,established; http_uri; content:".htr",nocase; http_header; content:"Transfer-Encoding|3A|",nocase; content:"chunked",nocase; metadata:ruleset community; service:http; reference:bugtraq,4855; reference:bugtraq,5003; reference:cve,2002-0364; reference:nessus,11028; classtype:web-application-attack; sid:1806; rev:20; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS repost.asp access"; flow:to_server,established; http_uri; content:"/scripts/repost.asp",nocase; metadata:ruleset community; service:http; reference:nessus,10372; classtype:web-application-activity; sid:1076; rev:18; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS MDAC Content-Type overflow attempt"; flow:to_server,established; http_uri; content:"/msadcs.dll",nocase; pkt_data; content:"Content-Type|3A|",nocase; isdataat:50,relative; content:!"|0A|",within 50; pcre:"/^POST\s/smi"; metadata:ruleset community; service:http; reference:bugtraq,6214; reference:cve,2002-1142; reference:nessus,11161; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-065; reference:url,technet.microsoft.com/en-us/security/bulletin/MS98-004; reference:url,www.foundstone.com/knowledge/randd-advisories-display.html?id=337; classtype:web-application-attack; sid:1970; rev:22; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS UNC mapped virtual host file source code access attempt"; flow:to_server,established; http_raw_uri; content:"asp|25|5C",nocase; pcre:"/asp\x255c$/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,1081; reference:cve,2000-0246; reference:url,technet.microsoft.com/en-us/security/bulletin/MS00-019; classtype:attempted-recon; sid:24866; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS UNC mapped virtual host file source code access attempt"; flow:to_server,established; http_raw_uri; content:"htr|25|5C",nocase; pcre:"/htr\x255C$/i"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,1081; reference:cve,2000-0246; reference:url,technet.microsoft.com/en-us/security/bulletin/MS00-019; classtype:attempted-recon; sid:24867; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS .NET null character username truncation attempt"; flow:to_server,established; http_method; content:"POST",nocase; http_uri; content:".asp",nocase; http_client_body; content:"user",nocase; content:"=",within 5; pcre:"/(^|&)user(name|id)?=[^&$]*?(\x00|%00)/ims"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-3416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-100; classtype:suspicious-login; sid:25250; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows IIS .NET null character username truncation attempt"; flow:to_server,established; http_method; content:"POST",nocase; http_uri; content:".asp",nocase; http_client_body; content:"email="; pcre:"/(^|&)email=[^&$]*?(\x00|%00)/ims"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-3416; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-100; classtype:suspicious-login; sid:25251; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7000 ( msg:"SERVER-IIS Microsoft Windows Server 2012 IIS OData protocol nested replace filter dos attempt"; flow:to_server,established; http_uri; content:"replace|28|replace|28|replace|28|replace|28|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2013-0005; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-007; classtype:attempted-dos; sid:25274; rev:4; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Windows ASP .NET denial of service attempt"; flow:to_server,established,only_stream; http_uri; content:".aspx",fast_pattern,nocase; http_method; content:"POST"; http_header; content:"Expect|3A| 100-continue"; content:"Connection|3A| Keep-Alive"; detection_filter:track by_src, count 1000, seconds 1; metadata:policy max-detect-ips drop; service:http; reference:cve,2014-0253; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-009; classtype:denial-of-service; sid:29715; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"SERVER-IIS Microsoft Windows Server 2012 IIS OData protocol nested replace filter dos attempt"; flow:to_server,established; content:"replace|28|replace|28|replace|28|replace|28|",depth 250,nocase; content:"HTTP|2F|",within 500,nocase; content:"Host|3A|",nocase; metadata:policy max-detect-ips drop; reference:cve,2013-0005; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-007; classtype:attempted-dos; sid:29866; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft IIS Range header integer overflow attempt"; flow:to_server,established; http_header; content:"Range",nocase; content:"bytes",distance 0,nocase; content:!"|0A|",within 12; pcre:"/^Range\s*\x3a\s*bytes\s*\x3d[^\x0a]*?\d{11}/im"; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; reference:bugtraq,74013; reference:cve,2015-1635; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-034; classtype:attempted-dos; sid:34061; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Web.config information disclosure attempt"; flow:to_server,established; http_uri; content:"/ /",fast_pattern,nocase; pcre:"/\x2F\x20\x2F$/"; metadata:policy max-detect-ips drop; service:http; reference:cve,2015-1648; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-041; classtype:web-application-attack; sid:34088; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft IIS ASP handling buffer overflow attempt "; flow:to_server,established; content:"%f4%8f%bf%bf%f4%8f%bf%bf",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,27676; reference:cve,2008-0075; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-006; classtype:web-application-attack; sid:15974; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft IIS HTMLEncode Unicode string buffer overflow "; flow:to_server,established; content:"%ud"; pcre:"/%ud[8-f]..%ud[8-f]../"; metadata:policy max-detect-ips drop; reference:cve,2008-0075; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-006; classtype:web-application-attack; sid:13922; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft IIS HTMLEncode Unicode string buffer overflow "; flow:to_server,established; content:"%d"; pcre:"/%d[8-f]%..%d[8-f]%../"; metadata:policy max-detect-ips drop; service:http; reference:cve,2008-0075; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-006; classtype:web-application-attack; sid:13476; rev:10; )
alert tcp $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any ( msg:"SERVER-IIS Microsoft ASP.NET bad request denial of service attempt "; flow:to_client,established,only_stream; http_stat_code; content:"400"; http_header; content:"Server|3A| Microsoft-IIS/",nocase; content:"X-Powered-By|3A| ASP.NET",nocase; detection_filter:track by_dst, count 11, seconds 1; metadata:policy max-detect-ips drop; service:http; reference:cve,2009-1536; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-036; classtype:attempted-dos; sid:15851; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft Active Directory Federation Services wct parameter cross site scripting attempt"; flow:to_server,established; http_uri; content:"/adfs/ls/",fast_pattern,nocase; content:"wct=",nocase; pcre:"/[?&]wct=[^&]*?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2015-1757; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-062; classtype:attempted-user; sid:34769; rev:3; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft ASP.NET bad request denial of service attempt"; flow:to_server,established; http_uri; content:".asmx",fast_pattern,nocase; http_raw_uri; content:"%"; pcre:"/%([01]|2([056A]|E%2E)|3[ACEF]|5C)/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2009-1536; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-036; classtype:denial-of-service; sid:43807; rev:1; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft ASP.NET bad request denial of service attempt"; flow:to_server,established; http_uri; content:".aspx",fast_pattern,nocase; http_raw_uri; content:"%"; pcre:"/%([01]|2([056A]|E%2E)|3[ACEF]|5C)/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2009-1536; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-036; classtype:denial-of-service; sid:43808; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-IIS Microsoft IIS IDC ISAPI cross-site scripting attempt"; flow:to_server,established; http_uri; content:"alert(",fast_pattern,nocase; content:"/<<",depth 3; content:">.idc",distance 0; metadata:policy max-detect-ips drop; service:http; reference:url,sans.org/reading-room/whitepapers/win2k/security-holes-isapi-extensions-209; classtype:web-application-attack; sid:51780; rev:1; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"SERVER-IIS Microsoft ASP.NET bad request denial of service attempt"; flow:to_server,established; http_uri; content:".mspx",fast_pattern,nocase; http_raw_uri; content:"%"; pcre:"/%([01]|2([056A]|E%2E)|3[ACEF]|5C)/i"; metadata:policy max-detect-ips drop; service:http; reference:cve,2009-1536; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-036; classtype:denial-of-service; sid:56804; rev:1; )
