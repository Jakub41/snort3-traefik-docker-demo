# Copyright 2001-2013 Sourcefire Inc. All Rights Reserved.
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright  Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002- Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#------------
# OS-MOBILE
#------------

alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Gmaster device information send"; flow:to_server,established; http_client_body; content:"uid=",nocase; content:"imei=",nocase; content:"simNum=",nocase; content:"telNum=",nocase; content:"imsi=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-082404-5049-99&tabid=2; classtype:trojan-activity; sid:26026; rev:4; )
# fast_pattern's 'only' option has been deleted
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Tetus device information leakage"; flow:to_server, established; http_header; content:"User-Agent: Dalvik",fast_pattern,nocase; http_uri; content:"imei=",nocase; content:"lpn=",nocase; content:"vd=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/855332267ffd1fb671d916822ea2929bef8974441a34cb4d9eb9c9b60ba6481f/analysis/; classtype:trojan-activity; sid:26938; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Tetus device information leakage variant"; flow:to_server, established; http_header; content:"User-Agent: Dalvik",fast_pattern,nocase; http_uri; content:"imei=",nocase; content:"referrer=",nocase; content:"pid=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/855332267ffd1fb671d916822ea2929bef8974441a34cb4d9eb9c9b60ba6481f/analysis/; classtype:trojan-activity; sid:26939; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android ANDR-WIN.MSIL variant PC-USB Malicious executable file download"; flow:to_server,established; http_uri; pcre:"/\x2f[^\x26\x2f\x3f]+?\x2e(exe|zip)$/i"; http_header; content:"Host|3A| claco.",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.securelist.com/en/blog/805/Mobile_attacks; classtype:trojan-activity; sid:26257; rev:5; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android ANDR.Trojan.ZertSecurity apk download"; flow:to_client,established; flowbits:isset,file.apk; file_data; content:"c|00|o|00|m|00|.|00|c|00|e|00|a|00|n|00|d|00|r|00|o|00|i|00|d|00|.|00|s|00|e|00|c|00|u|00|r|00|i|00|t|00|y|00|.|00|z|00|e|00|r|00|t",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,blog.lookout.com/blog/2013/05/06/zertsecurity; classtype:trojan-activity; sid:26795; rev:6; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android ANDR.Trojan.Opfake APK file download"; flow:to_client,established; file_data; flowbits:isset,file.apk; content:"n|00|g|00|j|00|v|00|n|00|p|00|s|00|l|00|n|00|p|00|.|00|i|00|p|00|l|00|h|00|m|00|k",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,www.virustotal.com/en/file/f2648dc7bc964dc7690c60575ad526ba5b23a0f09312fd7ebf4fa65a379919ca/analysis/; classtype:trojan-activity; sid:26783; rev:8; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android ANDR.Trojan.Chuli APK file download attempt"; flow:to_server,established; flowbits:isset,file.apk; file_data; content:"h|00|t|00|t|00|p|00|:|00|/|00|/|00|6|00|4|00 2E 00|7|00|8|00 2E 00|1|00|6|00|1|00 2E 00|1|00|3|00|3",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:smtp; reference:url,www.securelist.com/en/blog/208194186/Android_Trojan_Found_in_Targeted_Attack; classtype:trojan-activity; sid:26273; rev:5; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android ANDR.Trojan.Chuli APK file download attempt"; flow:to_client,established; flowbits:isset,file.apk; file_data; content:"h|00|t|00|t|00|p|00|:|00|/|00|/|00|6|00|4|00 2E 00|7|00|8|00 2E 00|1|00|6|00|1|00 2E 00|1|00|3|00|3",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,www.securelist.com/en/blog/208194186/Android_Trojan_Found_in_Targeted_Attack; classtype:trojan-activity; sid:26272; rev:6; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android ANDR.Trojan.PremiumSMS APK file download attempt"; flow:to_server,established; flowbits:isset,file.apk; file_data; content:"c|00|o|00|m|00|.|00|z|00|w|00|x|00|.|00|f|00|l|00|y|00|a|00|p|00|p",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:smtp; reference:url,blog.trustgo.com/trojanextension-a-complex-malware-escapes-av-detection/; classtype:trojan-activity; sid:26247; rev:5; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android ANDR.Trojan.PremiumSMS APK file download attempt"; flow:to_client,established; flowbits:isset,file.apk; file_data; content:"c|00|o|00|m|00|.|00|z|00|w|00|x|00|.|00|f|00|l|00|y|00|a|00|p|00|p",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,blog.trustgo.com/trojanextension-a-complex-malware-escapes-av-detection/; classtype:trojan-activity; sid:26246; rev:6; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android SMSZombie APK file download"; flow:to_client,established; file_data; content:"assets/a33.jpg",fast_pattern,nocase; flowbits:set,file.smszombie; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; reference:url,blog.trustgo.com/SMSZombie/; classtype:trojan-activity; sid:23969; rev:9; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android SMSZombie APK file download attempt"; flow:to_client,established; flowbits:isset,file.apk; flowbits:isset,file.smszombie; file_data; content:"b|00|a|00|o|00|x|00|i|00|a|00|n|00|_|00|z|00|h|00|u|00|s|00|h|00|o|00|u",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,blog.trustgo.com/SMSZombie/; classtype:trojan-activity; sid:23954; rev:11; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android ANDR.Trojan.Opfake device information disclosure attempt"; flow:to_server,established; http_uri; content:"/q.php",nocase; http_header; content:"Apache-HttpClient/UNAVAILABLE (java 1.",fast_pattern,nocase; http_client_body; content:"log",depth 3,nocase; content:"Executing",distance 0,nocase; content:"sendSMS",distance 0,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,blog.avast.com/2012/10/31/double-trouble/; classtype:trojan-activity; sid:26827; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android ANDR.Trojan.Opfake credential theft attempt"; flow:to_server,established; http_uri; content:"/login.php",nocase; http_header; content:"|28|Linux|3B| U|3B| Android 2.",fast_pattern,nocase; http_client_body; content:"user_id=",nocase; content:"&password=",distance 0,nocase; content:"&submit=",distance 0,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,blog.avast.com/2012/10/31/double-trouble/; classtype:trojan-activity; sid:26826; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Fakedoc device information leakage"; flow:to_server, established; http_uri; content:"&locale_source_term_network_sim=",fast_pattern,nocase; content:"network=",nocase; content:"&did=",nocase; content:"&model=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/85c4f3066b76671aab7148b98766e6b904c83cd0920187ec4bbd5af8c9e9c970/analysis/; classtype:trojan-activity; sid:26768; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Fakeinst device information leakage"; flow:to_server, established; http_header; content:"Apache-HttpClient/UNAVAILABLE (java 1.4)|0D 0A|",fast_pattern,nocase; http_client_body; content:"imei=",nocase; content:"imsi=",nocase; content:"msisdn=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/0a77e1aac4720037e2946edf84d957616e564bd525e444cf3994f5ae4b9374ab/analysis/; classtype:trojan-activity; sid:26761; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Fakeinst device information leakage"; flow:to_server, established; http_header; content:"User-Agent: Dalvik/",fast_pattern,nocase; http_uri; content:"imei=",nocase; content:"imsi=",nocase; content:"phone=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/0a77e1aac4720037e2946edf84d957616e564bd525e444cf3994f5ae4b9374ab/analysis/; classtype:trojan-activity; sid:26760; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Ewalls device information exfiltration"; flow:to_server, established; http_client_body; content:"uniquely_code=",fast_pattern,nocase; content:"imsi_mcc",nocase; content:"build_model",nocase; content:"line1_number",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,attack.mitre.org/techniques/T1020; reference:url,www.virustotal.com/en/file/1318b052ac129baf53b004e2e4a7002f4bf8654c1dd9381c4cbf7a535b5c5106/analysis/; classtype:trojan-activity; sid:26705; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Antammi device information exfiltration"; flow:to_server,established; http_client_body; content:"network_mcc",fast_pattern,nocase; content:"imsi=",nocase; content:"phone_number=",nocase; content:"sim_id=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,attack.mitre.org/techniques/T1020; reference:url,www.virustotal.com/en/file/10e2d89226c48d0d9fc08168cc5e508cd9afc6d08c262e70f02b7de607ef548a/analysis/; classtype:trojan-activity; sid:26693; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Denofow phone information exfiltration"; flow:to_server,established; http_header; content:"SOAPAction: ",fast_pattern,nocase; http_client_body; content:"</opname>",nocase; content:"</cell>",nocase; content:"</openmic>",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,attack.mitre.org/techniques/T1020; reference:url,www.virustotal.com/en/file/fc0417fd719f457f172a5c3fbb8fc155a04f2376b2ca4155395e01a028908038/analysis/; classtype:trojan-activity; sid:26689; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 30125 ( msg:"OS-MOBILE Android MDK encrypted information leak"; flow:to_server,established; content:"Host: app.looking3g.com",nocase; content:"/serv?",nocase; content:"User-Agent: Apache-HttpClient/UNAVAILABLE (java 1.4)",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,androidmalwaredump.blogspot.com/2013/01/androidtrojmdk-aka-androidksapp.html; classtype:trojan-activity; sid:26443; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android MDK encrypted information leak"; flow:to_server,established; http_header; content:"Host: wap.juliu.net",nocase; http_uri; content:"/control.html?",nocase; http_header; content:"User-Agent: Apache-HttpClient/UNAVAILABLE (java 1.4)",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,androidmalwaredump.blogspot.com/2013/01/androidtrojmdk-aka-androidksapp.html; classtype:trojan-activity; sid:26442; rev:4; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android Stels server response"; flow:to_client,established; file_data; content:"{|22|removeAllSmsFilters|22|:",fast_pattern,nocase; content:",|22|wait|22|:"; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/03c1b44c94c86c3137862c20f9f745e0f89ce2cdb778dc6466a06a65b7a591ae/analysis/; classtype:trojan-activity; sid:26388; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Stels initial server contact"; flow:to_server,established; http_client_body; content:"--AaB03x",nocase; content:"Content-Disposition",fast_pattern,nocase; content:"botId",nocase; content:"imsi",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/03c1b44c94c86c3137862c20f9f745e0f89ce2cdb778dc6466a06a65b7a591ae/analysis/; classtype:trojan-activity; sid:26387; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 5222 ( msg:"OS-MOBILE Android Ksapp device registration"; flow:to_server,established; http_uri; content:"/kspp/do?imei=",fast_pattern,nocase; content:"&wid=",nocase; content:"&type=&step=0",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2012-091722-4052-99; classtype:trojan-activity; sid:26291; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android ANDR.Trojan.RootSmart outbound communication attempt"; flow:to_server,established; http_client_body; content:"c:root=",fast_pattern,nocase; content:"/androidService/services/AndroidService"; content:"IMEI",distance 0; content:"&amp|3B|IMSI",within 9,distance 16; content:"&amp|3B|TYPE_TEL",within 18,distance 16; content:"INSTALL_TYPE",distance 0; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/8cb40e8dce05482907ff83b39911831daf20e4a69ee63a6cff523c880eed1acf/analysis/; classtype:trojan-activity; sid:26290; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Fakenetflix email password upload"; flow:to_server,established; http_header; content:"Host|3A| erofolio.no-ip.biz",fast_pattern,nocase; http_client_body; content:"email=",nocase; content:"&pass=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-101105-0518-99&tabid=2; classtype:trojan-activity; sid:26205; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android CruseWind imei leakage"; flow:to_server,established; http_uri; content:"/flash/test.xml?imei=",fast_pattern,nocase; content:"&time=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-070301-5702-99&tabid=2; classtype:trojan-activity; sid:26192; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android YZHC device registration"; flow:to_server,established; http_uri; content:"action=domregbycode&",fast_pattern,nocase; content:"channe="; content:"imsi="; content:"code="; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.csc.ncsu.edu/faculty/jiang/YZHCSMS/; classtype:trojan-activity; sid:26190; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 9888 ( msg:"OS-MOBILE Android YZHC device registration"; flow:to_server,established; content:"networklocale=",fast_pattern,nocase; content:"networkname="; content:"networkcode="; content:"register?imei="; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.csc.ncsu.edu/faculty/jiang/YZHCSMS/; classtype:trojan-activity; sid:26189; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Zitmo trojan intercepted sms upload"; flow:to_server,established; http_uri; content:"/security.jsp",nocase; http_client_body; content:"f0=",nocase; content:"&b0=",nocase; content:"&pid=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,blog.fortinet.com/zitmo-hits-android/; classtype:trojan-activity; sid:26114; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android KMin imei imsi leakage"; flow:to_server,established; http_uri; content:"/portal/m/c",nocase; content:".ashx?",nocase; content:"&nt2=",nocase; content:"&tp=2",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-093001-2649-99&tabid=2; classtype:trojan-activity; sid:26104; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android GoldDream device registration"; flow:to_server,established; http_uri; content:"/zj/RegistUid.aspx?pid=",nocase; content:"&imsi=",nocase; content:"&imei=",nocase; content:"&sim=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.cs.ncsu.edu/faculty/jiang/GoldDream/; classtype:trojan-activity; sid:26102; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android GoneIn60Seconds data upload"; flow:to_server,established; http_client_body; content:"data=",nocase; content:"contacts%22%3a",nocase; content:"sms%22%3a",nocase; content:"recent%22%3a",nocase; content:"url%22%3a",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-093001-2649-99&tabid=2; classtype:trojan-activity; sid:26087; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android GGTracker installation call out"; flow:to_server,established; http_uri; content:"/SM",nocase; content:"|3F|device_id=",nocase; content:"|26|adv_sub=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,blog.lookout.com/blog/2011/06/20/security-alert-android-trojan-ggtracker-charges-victims-premium-rate-sms-messages/; classtype:trojan-activity; sid:26018; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android GGTracker leak of device phone number"; flow:to_server,established; http_uri; content:"notif.php?phone=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,blog.lookout.com/blog/2011/06/20/security-alert-android-trojan-ggtracker-charges-victims-premium-rate-sms-messages/; classtype:trojan-activity; sid:26017; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android GGTracker server communication"; flow:to_server,established; http_client_body; content:"number=",nocase; content:"carrier=",nocase; content:"message=",nocase; content:"sdk=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,blog.lookout.com/blog/2011/06/20/security-alert-android-trojan-ggtracker-charges-victims-premium-rate-sms-messages/; classtype:trojan-activity; sid:26016; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Lovetrap initial connection"; flow:to_server,established; http_uri; content:"positionrecorder.asmx",nocase; content:"imsi=",nocase; content:"appid=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-072806-2905-99&tabid=2; classtype:trojan-activity; sid:26015; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android ADRD encrypted information leak"; flow:to_server,established; http_uri; content:".aspx?im=",nocase; http_header; content:"User-Agent: Apache-HttpClient/UNAVAILABLE (java 1.4)",fast_pattern,nocase; content:"Accept-Language: zh-CN, en-US",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-072806-2905-99&tabid=2; classtype:trojan-activity; sid:25999; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android ADRD encrypted information leak"; flow:to_server,established; http_uri; content:".aspx?im=",nocase; http_header; content:"User-Agent: J2ME/UCWEB7.4.0.57",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2011-072806-2905-99&tabid=2; classtype:trojan-activity; sid:25998; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android jSMSHider initial encrypted device info send"; flow:to_server,established; http_client_body; content:"svs=",nocase; content:"sid=",nocase; content:"ssd=",nocase; content:"sta=",nocase; content:"sac=",nocase; content:"sci=",nocase; content:"sch=",nocase; content:"stp=",nocase; content:"svr=",nocase; content:"sig=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,blog.lookout.com/blog/2011/06/15/security-alert-malware-found-targeting-custom-roms-jsmshider/; classtype:trojan-activity; sid:25997; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android.Trojan.Rus.SMS outbound communication attempt"; flow:established,to_server; http_client_body; content:"imei=",depth 5; content:"&time=",within 6,distance 15; content:"&os=",distance 0; content:"&imsi=",distance 0; content:"&v=",within 3,distance 15; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/664725869278f478e5a50a5e359dc6d5cf4f2a7019d0c122e2fa1e318f19636b/analysis/; classtype:trojan-activity; sid:25868; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android AngryBirdsRioUnlocker initial device info send"; flow:to_server,established; http_client_body; content:"|22|userId|22 3A 22|NOT IN USE!!!|22|",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.geek.com/articles/mobile/google-removes-malicious-angry-birds-apps-from-android-market-20110614/; classtype:trojan-activity; sid:25864; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android ANDR.Trojan.SMSsend variant outbound connection"; flow:established,to_server; http_uri; content:"/rq.php"; http_header; content:"Apache-HttpClient/UNAVAILABLE (java 1.",fast_pattern,nocase; http_client_body; content:"name=",depth 5; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/file/2076cb718edae12fa641a6b28cc53aee8d9d495518836bcc24e8e8bd1172f892/analysis/; classtype:trojan-activity; sid:25512; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android/Fakelash.A!tr.spy trojan command and control channel traffic"; flow:to_server,established; http_uri; content:"/data.php?action=",nocase; content:"&m=",distance 0,nocase; content:"&p=",distance 0,nocase; content:"&n=",distance 0,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:url,blog.fortiguard.com/android-malware-distributed-by-malicious-sms-in-france/; classtype:trojan-activity; sid:24251; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 2018 ( msg:"OS-MOBILE Android/Nickispy.D initialization request detection"; flow:to_server,established; content:"|00 00 00 27 00 00 00 09 80|",depth 9; metadata:impact_flag red,policy max-detect-ips drop; reference:url,www.virustotal.com/#/file/57f771d7809aa35599f81de9ea0120d3/detection; classtype:trojan-activity; sid:21595; rev:6; )
alert tcp $EXTERNAL_NET 2018 -> $HOME_NET any ( msg:"OS-MOBILE Android/Nickispy.D initialization response detection"; flow:to_client,established; content:"|00 00 00 27 00 80 00 09 80|",depth 9; metadata:impact_flag red,policy max-detect-ips drop; reference:url,www.virustotal.com/#/file/57f771d7809aa35599f81de9ea0120d3/detection; classtype:trojan-activity; sid:21596; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 2018 ( msg:"OS-MOBILE Android/Nickispy.D sms logging request detection"; flow:to_server,established; content:"|00 00 00 05 80|",depth 5,offset 4; metadata:impact_flag red,policy max-detect-ips drop; reference:url,www.virustotal.com/#/file/57f771d7809aa35599f81de9ea0120d3/detection; classtype:trojan-activity; sid:21597; rev:6; )
alert tcp $EXTERNAL_NET 2018 -> $HOME_NET any ( msg:"OS-MOBILE Android/Nickispy.D sms logging response detection"; flow:to_client,established; content:"|00 00 00 27 00 80 00 05 80|",depth 9; metadata:impact_flag red,policy max-detect-ips drop; reference:url,www.virustotal.com/#/file/57f771d7809aa35599f81de9ea0120d3/detection; classtype:trojan-activity; sid:21598; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Zitmo trojan command and control channel traffic"; flow:to_server,established; http_uri; content:"/update/biwdr.php",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:url,www.securelist.com/en/blog/208193604/Android_Security_Suite_Premium_New_ZitMo; classtype:trojan-activity; sid:23173; rev:6; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Apple iOS 6.x jailbreak download attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"evasi0n-win-",fast_pattern,nocase; content:"evasi0n.exe",nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,evasi0n.com/; classtype:attempted-admin; sid:25615; rev:5; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Apple iOS 6.x jailbreak download attempt"; flow:to_server,established; flowbits:isset,file.zip; file_data; content:"evasi0n-win-",fast_pattern,nocase; content:"evasi0n.exe",nocase; metadata:policy max-detect-ips drop; service:smtp; reference:url,evasi0n.com/; classtype:attempted-admin; sid:25616; rev:5; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Apple iOS 4.3.3 jailbreak for iPod download attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|78 DA ED DD 07 3C 97 FB FF 3F 7E 23 0D 23 CA C8 28 69 90 64 13 21 44 85 B2 0A 91 68 C8 DE 5B 46|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19419; rev:11; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Apple iOS 4.3.3 jailbreak for iPhone download attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|78 DA ED DD 07 3C D7 7B FF 3F 7E 2A 29 15 1A 94 64 A5 32 B2 25 45 94 0A 89 22 85 64 25 7B CB DE|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19418; rev:10; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Apple iOS 4.3.3 jailbreak for iPad download attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|28 69 90 CC 10 42 88 0A D9 21 25 52 F6 DE 23 23|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19417; rev:10; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Apple iOS 4.3.3 jailbreak for iPad download attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|78 DA ED DD 07 5C 8E FB E3 3F FE 86 8C 86 A2 A1 41 32 22 69 A7 52 69 A2 D2 56 89 64 A5 BD 35 35|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19416; rev:10; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android AnserverBot initial contact"; flow:to_server,established; http_uri; content:"/jk.action?a=",fast_pattern,nocase; content:"&key=",nocase; content:"&g1=",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.csc.ncsu.edu/faculty/jiang/AnserverBot/; classtype:trojan-activity; sid:27016; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Satfi device information leakage"; flow:to_server, established; http_uri; content:"confabcode="; content:"msisdn=",distance 0,nocase; content:"imsi=",distance 0,nocase; content:"operator=",distance 0,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/C149AC741A3A1336193D355A7F59A4911D9B6FC8F88307F8EC86C85C10C9059A/analysis/; classtype:trojan-activity; sid:27031; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Walkinwat / Wandt information leakage generic"; flow:to_server, established; http_client_body; content:"SECOND_TABLE=",fast_pattern,nocase; content:"imei=",nocase; content:"phone",nocase; http_uri; content:"wat.php",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/c6eb43f2b7071bbfe893fc78419286c3cb7c83ce56517bd281db5e7478caf995/analysis/; classtype:trojan-activity; sid:27032; rev:3; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android Vidro / EClips sms send instructions"; flow:to_client, established; file_data; content:"|22|messaging_update_interval|22|",fast_pattern,nocase; content:"|22|short_code|22|",nocase; content:"|22|send_sms|22|",nocase; content:"|22|messaging_intents|22|",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/67e5c171463284894e4521fe9d255bd29e16ed4936d972392d180e207f05daba/analysis/; classtype:trojan-activity; sid:27037; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Vidro / EClips device information leakage"; flow:to_server, established; http_client_body; content:"|22|messagingqueue_size|22|",fast_pattern,nocase; content:"|22|sim_msisdn|22|",nocase; content:"|22|device_imei|22|",nocase; content:"|22|sim_imsi|22|",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/67e5c171463284894e4521fe9d255bd29e16ed4936d972392d180e207f05daba/analysis/; classtype:trojan-activity; sid:27038; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 7766 ( msg:"OS-MOBILE Android Spy2Mobile device information leakage"; flow:to_server, established; content:"|22|protocol_ver|22|:",fast_pattern,nocase; content:"|22|imei|22|:",nocase; content:"|22|version|22|:",nocase; content:"|22|packet|22|:",nocase; metadata:impact_flag red,policy max-detect-ips drop; reference:url,www.virustotal.com/en/file/35f87a74a89a6ef69a68e8387671a36e26afd2df68136feac4be6c381d049005/analysis/; classtype:trojan-activity; sid:27064; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android ANDR.Trojan.FakeToken information disclosure attempt"; flow:to_server,established; http_uri; content:"/cp/server.php",nocase; http_header; content:"|28|Linux|3B| U|3B| Android 2.",fast_pattern,nocase; http_client_body; content:"imei",nocase; content:"sid_1",distance 0,nocase; content:"smsResults",distance 0,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/f7c36355c706fc9dd8954c096825e0613807e0da4bd7f3de97de0aec0be23b79/analysis/; classtype:trojan-activity; sid:27094; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android ANDR.Trojan.FakeToken APK file download attempt"; flow:to_client,established; flowbits:isset,file.apk; file_data; content:"OriginalDocumentID=|22|uuid:053FFFFBB1EEE0119F83A87C5C1D6A29",fast_pattern,nocase; content:"xmp.iid:601E7F76F132E1118DA2D9C4A1B3D877",nocase; metadata:impact_flag red,policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,www.virustotal.com/en/file/f7c36355c706fc9dd8954c096825e0613807e0da4bd7f3de97de0aec0be23b79/analysis/; classtype:trojan-activity; sid:27095; rev:4; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android ANDR.Trojan.SMSSilence APK file download attempt"; flow:to_client,established; file_data; flowbits:isset,file.apk; content:"c|00|o|00|m|00|.|00|v|00|e|00|r|00|t|00|u|00|.",fast_pattern,nocase; content:"dat.dat",nocase; content:"dat0.dat",within 200,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,www.virustotal.com/en/file/d36afc56bffe3716565bd9a7a82e3bb80dfd67eb5267ee531d19ba85b37916de/analysis/; classtype:trojan-activity; sid:27097; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android ANDR.Trojan.SMSSilence unsolicited sms attempt"; flow:to_server,established; http_uri; content:"/Android_SMS/receiving.php",nocase; http_header; content:"|28|Linux|3B| U|3B| Android 2.",fast_pattern,nocase; http_client_body; content:"mobile=",depth 7,nocase; content:"&revsms=",within 8,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/d36afc56bffe3716565bd9a7a82e3bb80dfd67eb5267ee531d19ba85b37916de/analysis/; classtype:trojan-activity; sid:27098; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android ANDR.Trojan.SMSSilence device information disclosure attempt"; flow:to_server,established; http_uri; content:"/Android_SMS/installing.php",nocase; http_header; content:"|28|Linux|3B| U|3B| Android 2.",fast_pattern,nocase; content:"Content-Length: 18",nocase; http_client_body; content:"mobile=",depth 7,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/d36afc56bffe3716565bd9a7a82e3bb80dfd67eb5267ee531d19ba85b37916de/analysis/; classtype:trojan-activity; sid:27099; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"OS-MOBILE Android Androrat device information leakage"; flow:to_server, established; content:"sr|00 13|java.util.Hashtable",fast_pattern,nocase; content:"PhoneNumber"; content:"SimOperator"; content:"IMEI"; metadata:impact_flag red,policy max-detect-ips drop; reference:url,www.virustotal.com/en/file/1af93c9fafdd21a33d647a79d1c36f5591432cb005edb3070768ddb1f333345a/analysis/; classtype:trojan-activity; sid:27116; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"OS-MOBILE Android Androrat sms message leakage"; flow:to_server, established; content:"sr|00 13|java.util.Arraylist",fast_pattern,nocase; content:"sr|00 10|Packet.SMSPacket"; content:"person"; content:"thread_id"; metadata:impact_flag red,policy max-detect-ips drop; reference:url,www.virustotal.com/en/file/1af93c9fafdd21a33d647a79d1c36f5591432cb005edb3070768ddb1f333345a/analysis/; classtype:trojan-activity; sid:27117; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"OS-MOBILE Android Androrat contact list leakage"; flow:to_server, established; content:"sr|00 13|java.util.Arraylist",fast_pattern,nocase; content:"sr|00 0D|utils.Contact"; content:"times_contacted"; metadata:impact_flag red,policy max-detect-ips drop; reference:url,www.virustotal.com/en/file/1af93c9fafdd21a33d647a79d1c36f5591432cb005edb3070768ddb1f333345a/analysis/; classtype:trojan-activity; sid:27118; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android Exploit Extra_Field APK file download attempt"; flow:to_client,established; flowbits:isset,file.apk; file_data; content:"PK|03 04|"; content:"|00 00|",within 2,distance 4; byte_test:2, >, 0x7FFF, 18, relative, little; content:"classes.dex",within 11,distance 20; metadata:impact_flag red,policy max-detect-ips drop; service:ftp-data, http, imap, pop3; classtype:trojan-activity; sid:27552; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Apple iPod User-Agent detected"; flow:established,to_server; http_header; content:"User-Agent|3A|"; content:"iPod",distance 0,fast_pattern; pcre:"/^User-Agent\x3a[^\r\n]*iPod/"; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:policy-violation; sid:25518; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Apple iPad User-Agent detected"; flow:established,to_server; http_header; content:"User-Agent|3A|"; content:"iPad",distance 0,fast_pattern; pcre:"/^User-Agent\x3a[^\r\n]*iPad/"; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:policy-violation; sid:25519; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Apple iPhone User-Agent detected"; flow:established,to_server; http_header; content:"User-Agent|3A|"; content:"iPhone",distance 0,fast_pattern; pcre:"/^User-Agent\x3a[^\r\n]*iPhone/"; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:policy-violation; sid:25520; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android User-Agent detected"; flow:established,to_server; http_header; content:"User-Agent|3A|"; content:"android",distance 0,fast_pattern,nocase; pcre:"/^User-Agent\x3a[^\r\n]*android/i"; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:policy-violation; sid:25521; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Nokia User-Agent detected"; flow:established,to_server; http_header; content:"User-Agent|3A|"; content:"nokia",distance 0,fast_pattern,nocase; pcre:"/^User-Agent\x3a[^\r\n]*nokia/i"; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:policy-violation; sid:25522; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Samsung User-Agent detected"; flow:established,to_server; http_header; content:"User-Agent|3A|"; content:"Samsung",distance 0,fast_pattern,nocase; pcre:"/^User-Agent\x3a[^\r\n]*samsung/i"; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:policy-violation; sid:25523; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Kindle User-Agent detected"; flow:established,to_server; http_header; content:"User-Agent|3A|"; content:"kindle",distance 0,fast_pattern,nocase; pcre:"/^User-Agent\x3a[^\r\n]*kindle/i"; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:policy-violation; sid:25524; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:"OS-MOBILE Android SMSAgent.C outbound SMTP communication"; flow:to_server,established; content:"18765435554=E5=AE=89=E8=A3=85=E6=88=90=E5=8A=9F----18765435554=E5=AE=89=E8=",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:url,www.f-secure.com/weblog/archives/00002594.html; reference:url,www.virustotal.com/en/file/fdc4983bdaaf97146caa84fe2c7ffdf8b3eb78bde8b828203a2c757e2506e865/analysis/; classtype:trojan-activity; sid:27725; rev:3; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android WebKit Java reflection command execution attempt"; flow:to_client,established; file_data; content:".getClass|28 29|.forName|28|",nocase; content:".getMethod",within 200; content:".invoke|28|null|2C|",within 150; metadata:policy max-detect-ips drop; service:http; reference:cve,2014-0514; reference:url,blogs.avg.com/mobile-2/analyzing-android-webview-exploit/; reference:url,helpx.adobe.com/security/products/reader-mobile/apsb14-12.html; reference:url,labs.mwrinfosecurity.com/blog/2013/09/24/webview-addjavascriptinterface-remote-code-execution/; classtype:attempted-user; sid:28043; rev:4; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android fake iMessage app download"; flow:to_client,established; flowbits:isset,file.apk; content:"HuLuWa Team",nocase; content:"Android version of iMessage",within 50; metadata:policy max-detect-ips drop; service:http; reference:url,plus.google.com/u/0/116098411511850876544/posts/UkgaXa1oa6M; reference:url,www.engadget.com/2013/09/24/imessage-for-android-app-risk/; classtype:trojan-activity; sid:28046; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android ANDR.Trojan.FakeAV outbound communication attempt"; flow:to_server,established; http_header; content:"User-Agent|3A 20|android|0D 0A|",fast_pattern; content:"Content-Type|3A| text|2F|plain|3B| charset|3D|utf-8"; http_uri; content:"&affid="; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/en/file/5f96e12b035ee083f11f0e121352258c2bc86132e13d95811ffc2f4d3304a74e/analysis/1380055877/; classtype:trojan-activity; sid:28055; rev:5; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android ANDR.Trojan.FakeAV APK file download attempt"; flow:to_client,established; flowbits:isset,file.apk; file_data; content:"c|00|o|00|m|00 2E 00|e|00|x|00|a|00|m|00|p|00|l|00|e|00 2E 00|a|00|n|00|d|00|r|00|o|00|i|00|d|00|d|00|e|00|f|00|e|00|n|00|d|00|e|00|r|00|2",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,www.virustotal.com/en/file/5f96e12b035ee083f11f0e121352258c2bc86132e13d95811ffc2f4d3304a74e/analysis/1380055877/; classtype:trojan-activity; sid:28056; rev:3; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android ANDR.Trojan.FakeAV APK file download attempt"; flow:to_server,established; flowbits:isset,file.apk; file_data; content:"c|00|o|00|m|00 00 00|e|00|x|00|a|00|m|00|p|00|l|00|e|00 00 00|a|00|n|00|d|00|r|00|o|00|i|00|d|00|d|00|e|00|f|00|e|00|n|00|d|00|e|00|r|00|2",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:smtp; reference:url,www.virustotal.com/en/file/5f96e12b035ee083f11f0e121352258c2bc86132e13d95811ffc2f4d3304a74e/analysis/1380055877/; classtype:trojan-activity; sid:28057; rev:3; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android ANDR.Trojan.Malapp APK file download attempt"; flow:to_server,established; flowbits:isset,file.apk; file_data; content:"c|00|o|00|m|00 2E 00|a|00|p|00|p|00 2E 00|l|00|o|00|t|00|t|00|e|00 2E 00|a|00|u|00|t|00|h",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:smtp; reference:url,www.virustotal.com/en/file/d95d7d2b6e3f73e83d93ec4df4afb681db93697e100011f6486fdfc44fbead34/analysis/; classtype:trojan-activity; sid:28081; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android ANDR.Trojan.Malapp APK file download attempt"; flow:to_client,established; flowbits:isset,file.apk; file_data; content:"c|00|o|00|m|00 2E 00|a|00|p|00|p|00 2E 00|l|00|o|00|t|00|t|00|e|00 2E 00|a|00|u|00|t|00|h",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,www.virustotal.com/en/file/d95d7d2b6e3f73e83d93ec4df4afb681db93697e100011f6486fdfc44fbead34/analysis/; classtype:trojan-activity; sid:28082; rev:3; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android ANDR.Trojan.SmsSpy APK file download attempt"; flow:to_server,established; flowbits:isset,file.apk; file_data; content:"com.android|00 00 00 00 00 00 02 1C 01 04 0A 00 00 7F 00 00 00|c|00|o|00|m|00 2E 00|C|00|o|00|p|00|o|00|n",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:smtp; reference:url,www.virustotal.com/en/file/0F540A52242E6D97E12AD9D85E8523F9AEE788AC8566284055E91155568DA714/analysis/; classtype:trojan-activity; sid:28086; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android ANDR.Trojan.SmsSpy APK file download attempt"; flow:to_client,established; flowbits:isset,file.apk; file_data; content:"com.android|00 00 00 00 00 00 02 1C 01 04 0A 00 00 7F 00 00 00|c|00|o|00|m|00 2E 00|C|00|o|00|p|00|o|00|n",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,www.virustotal.com/en/file/0F540A52242E6D97E12AD9D85E8523F9AEE788AC8566284055E91155568DA714/analysis/; classtype:trojan-activity; sid:28087; rev:3; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android Andr.Trojan.MobileTx APK file download attempt"; flow:to_server,established; flowbits:isset,file.apk; file_data; content:"assets/txconfig/splashimg.jsonPK",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:url,www.virustotal.com/en/file/a3ffa998c7865f2bf49fd148e7b56547e24eb95c/analysis/; classtype:trojan-activity; sid:28401; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android Andr.Trojan.MobileTx APK file download attempt"; flow:to_client,established; flowbits:isset,file.apk; file_data; content:"assets/txconfig/splashimg.jsonPK",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:url,www.virustotal.com/en/file/a3ffa998c7865f2bf49fd148e7b56547e24eb95c/analysis/; classtype:trojan-activity; sid:28402; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Andr.Trojan.MobileTx information disclosure attempt"; flow:to_server,established; http_header; content:"|28|Linux|3B| U|3B| Android 2.",fast_pattern,nocase; http_uri; content:"/client/reg.do",nocase; http_header; content:"Content-Length|3A| 20",nocase; http_client_body; content:"imsi=",depth 5,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:url,www.virustotal.com/en/file/a3ffa998c7865f2bf49fd148e7b56547e24eb95c/analysis/; classtype:trojan-activity; sid:28403; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android signature validation bypass APK file download attempt"; flow:to_client,established; flowbits:isset,file.apk; file_data; content:"PK|03 04|"; byte_test:2,>,0x500,22,relative,little; metadata:impact_flag red,policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:bugtraq,64529; reference:cve,2013-6792; reference:url,android.googlesource.com/platform/libcore/+/2da1bf57a6631f1cbd47cdd7692ba8743c993ad9%5E!; classtype:trojan-activity; sid:29418; rev:3; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android signature validation bypass APK file download attempt"; flow:to_server,established; flowbits:isset,file.apk; file_data; content:"PK|03 04|"; byte_test:2,>,0x500,22,relative,little; metadata:impact_flag red,policy max-detect-ips drop; service:smtp; reference:bugtraq,64529; reference:cve,2013-6792; reference:url,android.googlesource.com/platform/libcore/+/2da1bf57a6631f1cbd47cdd7692ba8743c993ad9%5E!; classtype:trojan-activity; sid:29419; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android Goodix gt915 touchscreen driver improper bounds-check privileged access attempt"; flow:to_client,established; file_data; content:"create_proc_entry|28|procname|2C| 0666|2C| NULL|29|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:bugtraq,63661; reference:cve,2013-4740; reference:cve,2013-6122; reference:url,www.codeaurora.org/projects/security-advisories/multiple-memory-corruption-issues-and-race-condition-goodix-gt915-touchscreen-driver-procfs-handler; classtype:attempted-user; sid:29437; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android Goodix gt915 touchscreen driver improper bounds-check privileged access attempt"; flow:to_server,established; file_data; content:"create_proc_entry|28|procname|2C| 0666|2C| NULL|29|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:bugtraq,63661; reference:cve,2013-4740; reference:cve,2013-6122; reference:url,www.codeaurora.org/projects/security-advisories/multiple-memory-corruption-issues-and-race-condition-goodix-gt915-touchscreen-driver-procfs-handler; classtype:attempted-user; sid:29438; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"OS-MOBILE Android Andr.Trojan.Waller information disclosure attempt"; flow:to_server,established; http_uri; content:"/farm.php?imei=",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,virustotal.com/en/file/8ea8ce79404dc6ba06fae16add7bc7859f23c70dbea601cad178dd4180e83299/analysis/; classtype:trojan-activity; sid:30880; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Apple iOS 8.x jailbreak download attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"Pangu_Main_Frame",fast_pattern,nocase; content:"sys.page.jbreak",nocase; content:"iOS 8.x",nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,pangu.io/; classtype:attempted-admin; sid:32274; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Apple iOS 8.x jailbreak download attempt"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"Pangu_Main_Frame",fast_pattern,nocase; content:"sys.page.jbreak",nocase; content:"iOS 8.x",nocase; metadata:policy max-detect-ips drop; service:smtp; reference:url,pangu.io/; classtype:attempted-admin; sid:32275; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android ObjectInputStream privilege escalation attempt"; flow:to_client,established; flowbits:isset,file.apk; file_data; content:"|93 68 3F 0F FA 59 D0 0B C0 97 81 C7 81 A5 98 E7 29 D0 B7 80 77 81 5F 03 3A 6C 79 10 C3 7E 20 08 D4 00 38 16|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:bugtraq,71176; reference:cve,2014-7911; classtype:attempted-user; sid:32974; rev:3; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android ObjectInputStream privilege escalation attempt"; flow:to_server,established; flowbits:isset,file.apk; file_data; content:"|93 68 3F 0F FA 59 D0 0B C0 97 81 C7 81 A5 98 E7 29 D0 B7 80 77 81 5F 03 3A 6C 79 10 C3 7E 20 08 D4 00 38 16|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:bugtraq,71176; reference:cve,2014-7911; classtype:attempted-user; sid:32975; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE iOS lockdownd plist object buffer overflow attempt"; flow:to_client, established; file_data; content:"|C7 04 24 D4 74 0E 33 E8 16 FB FF FF 89 45 D4 8B 45 D4 01 45 DC 8B 45 DC 89 44 24 04 C7 04 24 43 43 43 43|",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; classtype:attempted-admin; sid:35090; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 ( msg:"OS-MOBILE iOS lockdownd plist object buffer overflow attempt"; flow:to_server, established; file_data; content:"|C7 04 24 D4 74 0E 33 E8 16 FB FF FF 89 45 D4 8B 45 D4 01 45 DC 8B 45 DC 89 44 24 04 C7 04 24 43 43 43 43|",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:attempted-admin; sid:35091; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android Stagefright MP4 buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.mp4; file_data; content:"covr"; content:!"|00 00 00 01|",within 4,distance -8; byte_test:4,<=,24,-8,relative; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2015-1538; reference:cve,2015-1539; reference:cve,2015-3824; reference:cve,2015-3826; reference:cve,2015-3827; reference:cve,2015-3828; reference:cve,2015-3829; classtype:attempted-admin; sid:35434; rev:5; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android Stagefright MP4 buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.mp4; file_data; content:"covr"; content:!"|00 00 00 01|",within 4,distance -8; byte_test:4,<=,24,-8,relative; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2015-1538; reference:cve,2015-1539; reference:cve,2015-3824; reference:cve,2015-3826; reference:cve,2015-3827; reference:cve,2015-3828; reference:cve,2015-3829; classtype:attempted-admin; sid:35435; rev:5; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android WebKit Java reflection command execution attempt"; flow:to_server,established; file_data; content:".getClass|28 29|.forName|28|",nocase; content:".getMethod",within 200; content:".invoke|28|null|2C|",within 150; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2014-0514; reference:url,blogs.avg.com/mobile-2/analyzing-android-webview-exploit/; reference:url,helpx.adobe.com/security/products/reader-mobile/apsb14-12.html; reference:url,labs.mwrinfosecurity.com/blog/2013/09/24/webview-addjavascriptinterface-remote-code-execution/; classtype:attempted-user; sid:36360; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android WebKit Java reflection command execution attempt"; flow:to_server,established; file_data; content:"|38 A6 DA 62 78 91 83 45 A1 C1 C1 42 7F 1F D1 3B 85 FA AF 9B BF 50 A6 DE CE D3 93 CC B9 9E 41 FC|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2014-0514; reference:url,blogs.avg.com/mobile-2/analyzing-android-webview-exploit/; reference:url,helpx.adobe.com/security/products/reader-mobile/apsb14-12.html; reference:url,labs.mwrinfosecurity.com/blog/2013/09/24/webview-addjavascriptinterface-remote-code-execution/; classtype:attempted-user; sid:36361; rev:2; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android WebKit Java reflection command execution attempt"; flow:to_client,established; file_data; content:"|38 A6 DA 62 78 91 83 45 A1 C1 C1 42 7F 1F D1 3B 85 FA AF 9B BF 50 A6 DE CE D3 93 CC B9 9E 41 FC|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2014-0514; reference:url,blogs.avg.com/mobile-2/analyzing-android-webview-exploit/; reference:url,helpx.adobe.com/security/products/reader-mobile/apsb14-12.html; reference:url,labs.mwrinfosecurity.com/blog/2013/09/24/webview-addjavascriptinterface-remote-code-execution/; classtype:attempted-user; sid:36362; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Microsoft Outlook for Android stored cross-site script attempt"; flow:to_server,established; file_data; content:"<iframe"; content:"style=|22|position:absolute|3B|left:-",within 100,fast_pattern; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2019-1105; reference:url,portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1105; classtype:attempted-user; sid:51102; rev:1; )
alert tcp $HOME_NET [110,143] -> $EXTERNAL_NET any ( msg:"OS-MOBILE Microsoft Outlook for Android stored cross-site script attempt"; flow:to_client,established; file_data; content:"<iframe"; content:"style=|22|position:absolute|3B|left:-",within 100,fast_pattern; metadata:policy max-detect-ips drop,policy security-ips drop; service:imap, pop3; reference:cve,2019-1105; reference:url,portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1105; classtype:attempted-user; sid:51103; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Google Android Kernel local denial of service attempt"; flow:to_client,established; file_data; content:"|7D A6 5D 18 D7 1B 64 BF 21 C1 03 BD 19 C1 87 4D 63 93 71 6D 6C 1F 23 E9 4E C6 6E E9 2E 23 A6 EF|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2013-1773; reference:url,exploit-db.com/exploits/23248; classtype:denial-of-service; sid:51290; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Google Android Kernel local denial of service attempt"; flow:to_server,established; file_data; content:"|7D A6 5D 18 D7 1B 64 BF 21 C1 03 BD 19 C1 87 4D 63 93 71 6D 6C 1F 23 E9 4E C6 6E E9 2E 23 A6 EF|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2013-1773; reference:url,exploit-db.com/exploits/23248; classtype:denial-of-service; sid:51291; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android Stagefright MP4 buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.mp4; file_data; content:"ctts"; content:"|00 00 00|",within 3,distance 1; byte_test:4,>,0x1FFFFFFF,0,relative; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2015-1538; classtype:attempted-admin; sid:51857; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android Stagefright MP4 buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.mp4; file_data; content:"tx3g"; content:"|FF FF|",within 2,distance -7; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2015-3824; classtype:attempted-admin; sid:51858; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android Stagefright MP4 buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.mp4; file_data; content:"tx3g"; content:"|FF FF|",within 2,distance -7; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2015-3824; classtype:attempted-admin; sid:51859; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android Stagefright MP4 buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.mp4; file_data; content:"stsc"; content:"|00 00 00|",within 3,distance 1; byte_test:4,>,0x1FFFFFFF,0,relative; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2015-1538; classtype:attempted-admin; sid:51860; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android Stagefright MP4 buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.mp4; file_data; content:"stsc"; content:"|00 00 00|",within 3,distance 1; byte_test:4,>,0x1FFFFFFF,0,relative; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2015-1538; classtype:attempted-admin; sid:51861; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android Stagefright MP4 buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.mp4; file_data; content:"ctts"; content:"|00 00 00|",within 3,distance 1; byte_test:4,>,0x1FFFFFFF,0,relative; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2015-1538; classtype:attempted-admin; sid:51862; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android Stagefright MP4 buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.mp4; file_data; content:"stts"; content:"|00 00 00|",within 3,distance 1; byte_test:4,>,0x1FFFFFFF,0,relative; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2015-1538; classtype:attempted-admin; sid:51863; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android Stagefright MP4 buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.mp4; file_data; content:"stss"; content:"|00 00 00|",within 3,distance 1; byte_test:4,>,0x1FFFFFFF,0,relative; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2015-1538; classtype:attempted-admin; sid:51864; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android Stagefright MP4 buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.mp4; file_data; content:"stts"; content:"|00 00 00|",within 3,distance 1; byte_test:4,>,0x1FFFFFFF,0,relative; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2015-1538; classtype:attempted-admin; sid:51865; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android Stagefright MP4 buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.mp4; file_data; content:"stss"; content:"|00 00 00|",within 3,distance 1; byte_test:4,>,0x1FFFFFFF,0,relative; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2015-1538; classtype:attempted-admin; sid:51866; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android WhatsApp malformed GIF double-free remote code execution attempt"; flow:to_client,established; file_data; content:"GIF89a",depth 6; content:"|2C 00 00 00 00|",within 250; content:!"|00 00|",within 2; content:!"|00 00|",within 2,distance 2; content:"|2C 00 00 00 00|",within 500; content:"|00 00|",within 2,distance 2; content:"|2C 00 00 00 00|",within 100; content:"|00 00|",within 2,distance 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2019-11932; reference:url,awakened1712.github.io/hacking/hacking-whatsapp-gif-rce/; classtype:attempted-user; sid:51953; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android WhatsApp malformed GIF double-free remote code execution attempt"; flow:to_server,established; file_data; content:"GIF89a",depth 6; content:"|2C 00 00 00 00|",within 250; content:!"|00 00|",within 2; content:!"|00 00|",within 2,distance 2; content:"|2C 00 00 00 00|",within 500; content:"|00 00|",within 2,distance 2; content:"|2C 00 00 00 00|",within 100; content:"|00 00|",within 2,distance 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2019-11932; reference:url,awakened1712.github.io/hacking/hacking-whatsapp-gif-rce/; classtype:attempted-user; sid:51954; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android WhatsApp malformed GIF double-free remote code execution attempt"; flow:to_server,established; file_data; content:"GIF89a",depth 6; content:"|2C 00 00 00 00|",within 250; content:!"|00 00|",within 2; content:!"|00 00|",within 2,distance 2; content:"|2C 00 00 00 00 00 00|",within 500; content:"|2C 00 00 00 00 00 00|",within 100; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2019-11932; reference:url,awakened1712.github.io/hacking/hacking-whatsapp-gif-rce/; classtype:attempted-user; sid:51955; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android WhatsApp malformed GIF double-free remote code execution attempt"; flow:to_client,established; file_data; content:"GIF89a",depth 6; content:"|2C 00 00 00 00|",within 250; content:!"|00 00|",within 2; content:!"|00 00|",within 2,distance 2; content:"|2C 00 00 00 00 00 00|",within 500; content:"|2C 00 00 00 00 00 00|",within 100; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2019-11932; reference:url,awakened1712.github.io/hacking/hacking-whatsapp-gif-rce/; classtype:attempted-user; sid:51956; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android Stagefright MP4 buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.mp4; file_data; content:"|00 00 00 01|covr"; byte_test:4,>,0,0,relative; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2015-3829; classtype:attempted-admin; sid:52100; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android Stagefright MP4 buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.mp4; file_data; content:"|00 00 00 01|covr"; byte_test:4,>,0,0,relative; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2015-3829; classtype:attempted-admin; sid:52101; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Google Android libstagefright integer underflow attempt"; flow:to_client,established; flowbits:isset,file.mp4; file_data; content:"|00 00 00 01|tx3g"; content:!"|00 00 00 00|",within 4; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2015-3864; classtype:attempted-user; sid:52288; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Google Android libstagefright integer underflow attempt"; flow:to_server,established; flowbits:isset,file.mp4; file_data; content:"|00 00 00 01|tx3g"; content:!"|00 00 00 00|",within 4; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2015-3864; classtype:attempted-user; sid:52289; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-MOBILE Android Binder use after free exploit attempt"; flow:to_client,established; file_data; content:"|02 01 0A 8B 00 20 38 91 8A FE FF 97 68 16 40 F9 A9 83 5D F8 1F 01 09 EB C1 05 00 54 FF C3 08 91 FD 7B 42 A9 F4 4F 41 A9 FC 57 C3 A8 C0 03 5F D6|",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2019-2215; classtype:attempted-admin; sid:53344; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-MOBILE Android Binder use after free exploit attempt"; flow:to_server,established; file_data; content:"|02 01 0A 8B 00 20 38 91 8A FE FF 97 68 16 40 F9 A9 83 5D F8 1F 01 09 EB C1 05 00 54 FF C3 08 91 FD 7B 42 A9 F4 4F 41 A9 FC 57 C3 A8 C0 03 5F D6|",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2019-2215; classtype:attempted-admin; sid:53345; rev:1; )

