# Copyright 2001-2012 Sourcefire Inc. All Rights Reserved.
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2007 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2007 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#-------------------
# BROWSER-CHROME
#-------------------
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome GURL cross origin bypass attempt"; flow:to_client,established; file_data; content:"|3C|iframe",nocase; content:"src=|22|https|3A 2F 2F|www.google.com|2F|accounts|2F|ManageAccount?hl=fr|22|",within 100,nocase; content:"window.open|28 27|",within 500; content:"alert|28|document.cookie|29 27|",within 75; pcre:"/window\.open\x28\x27[\w\W]{0,35}\x3aalert\x28document\.cookie\x29\x27/smi"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,39813; reference:cve,2010-1663; classtype:attempted-user; sid:16667; rev:12; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Uninitialized bug_report Pointer Code Execution"; flow:to_client,established; flowbits:isset,file.crx; file_data; content:"|43 72 32 34|"; content:"|95 78 B9 6A 79 B9 00 50 4B 01 02 00 00 14 00 00|",distance 664; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:bugtraq,45788; reference:cve,2011-0470; reference:cve,2011-0471; reference:cve,2011-0472; reference:cve,2011-0473; reference:cve,2011-0474; reference:cve,2011-0475; reference:cve,2011-0476; reference:cve,2011-0477; reference:cve,2011-0478; reference:cve,2011-0479; reference:cve,2011-0480; reference:cve,2011-0481; reference:cve,2011-0482; reference:cve,2011-0483; reference:cve,2011-0484; reference:cve,2011-0485; classtype:attempted-user; sid:19217; rev:14; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Uninitialized bug_report Pointer Code Execution"; flow:to_client,established; flowbits:isset,file.crx; file_data; content:"|43 72 32 34|"; content:"|07 2A 6F D1 6B B6 E8 CB A4 A9 C4 9C 67 42 1C FE|",within 16,distance 537; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:bugtraq,45788; reference:cve,2011-0470; reference:cve,2011-0471; reference:cve,2011-0472; reference:cve,2011-0473; reference:cve,2011-0474; reference:cve,2011-0475; reference:cve,2011-0476; reference:cve,2011-0477; reference:cve,2011-0478; reference:cve,2011-0479; reference:cve,2011-0480; reference:cve,2011-0481; reference:cve,2011-0482; reference:cve,2011-0483; reference:cve,2011-0484; reference:cve,2011-0485; classtype:attempted-user; sid:19216; rev:14; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome GURL cross origin bypass attempt"; flow:to_client,established; file_data; content:"|3C|iframe",nocase; content:"src=|22|http|3A 2F 2F|www.google.ca|2F|language_tools?hl=en|22|",within 100,nocase; content:"window.open|28 27|",within 500; content:"alert|28|document.cookie|29 27|",within 75; pcre:"/window\.open\x28\x27[\w\W]{0,35}\x3aalert\x28document\.cookie\x29\x27/smi"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,39813; reference:cve,2010-1663; classtype:attempted-user; sid:16668; rev:11; )
alert tcp $EXTERNAL_NET 21 -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome FTP handling out-of-bounds array index denial of service attempt"; flow:to_client,established; content:"|22 22|"; pcre:"/^2\d{2}[^\n]*?\x22{2}/"; metadata:policy max-detect-ips drop; service:ftp; reference:bugtraq,39183; classtype:attempted-dos; sid:16795; rev:5; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome net-internals uri fragment identifier XSS attempt"; flow:established,to_client; file_data; content:"chrome://net-internals/view-cache/",nocase; pcre:"/^\x23([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/iR"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,39667; reference:cve,2010-1503; reference:url,code.google.com/p/chromium/issues/detail?id=40137; classtype:attempted-user; sid:23471; rev:6; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome and Apple Safari runin handling use after free attempt"; flow:to_client,established; file_data; content:"display: run-in|3B|"; content:"display: inline-table|3B|",distance 0; content:"document.execCommand('removeFormat')|3B|",distance 0; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2011-3068; classtype:attempted-user; sid:23015; rev:9; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome https spoofing attempt"; flow:to_client,established; file_data; content:"view|2D|source",nocase; content:"http|3A 2F 2F|",distance 1; content:"url|3D|https",distance 0; pcre:"/view\x2Dsource\x3Ahttp\x3A\x2F\x2F[^\x3B]*?url\x3Dhttps/smi"; metadata:policy max-detect-ips drop; service:http; reference:url,blog.acrossecurity.com/2012/01/google-chrome-https-address-bar.html; classtype:attempted-recon; sid:21166; rev:4; )
# fast_pattern's 'only' option has been deleted
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome and Apple Safari Ruby before and after memory corruption"; flow:to_client,established; file_data; content:"<ruby>",fast_pattern,nocase; content:"ruby|3A|"; pcre:"/(before|after).*?((display\x3atable|counter-reset\x3a)|(counter-reset\x3a|display\x3atable)).*?ruby\s*{\s*float\x3a/siR"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-1440; classtype:attempted-user; sid:20579; rev:8; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome float rendering corruption attempt"; flow:to_client,established; file_data; content:"display: list-item"; content:"display: -webkit-inline-box",fast_pattern,nocase; content:"removeChild|28|",nocase; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-1804; classtype:attempted-user; sid:19710; rev:10; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Apple Safari/Google Chrome Webkit memory corruption attempt"; flow:to_client,established; file_data; content:"|3C|dialog|20|style|3D 27|position|3A|relative|27 3E|",fast_pattern,nocase; content:"|3C|h|20|style|3D 27|outline|2D|style|3A|auto|27 3E|"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,43078; reference:cve,2010-1813; classtype:attempted-user; sid:19005; rev:9; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome and Apple Safari Ruby before and after memory corruption"; flow:to_client,established; file_data; content:"<ruby>",fast_pattern,nocase; content:"ruby|3A|"; pcre:"/ruby\s*{\s*float\x3a.*?ruby\x3a(before|after).*?(display\x3atable|counter-reset\x3a)/si"; metadata:policy max-detect-ips drop; service:http; reference:cve,2011-1440; classtype:attempted-user; sid:29755; rev:2; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome FileSystemObject function call"; flow:to_client,established; file_data; content:"Scripting.FileSystemObject",fast_pattern,nocase; content:"<script",nocase; content:"Scripting.FileSystemObject",distance 0,nocase; content:"</script>",distance 0,nocase; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,36947; reference:cve,2009-3931; classtype:attempted-user; sid:21447; rev:12; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome FileSystemObject clsid access"; flow:to_client,established; file_data; content:"clsid:0D43FE01-F093-11CF-8940-00A0C9054228",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,36947; reference:cve,2009-3934; classtype:attempted-user; sid:21446; rev:9; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome XSSAuditor filter security policy bypass attempt"; flow:to_client,established; file_data; content:"<iframe",nocase; content:"srcdoc",within 20,nocase; content:"<script>",within 10,nocase; pcre:"/<iframe[^>]*?srcdoc\s?=\s?[\x22\x27]<script>/smi"; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,65066; reference:url,blog.elevenpaths.com/2014/01/how-to-bypass-antixss-filter-in-chrome.html; reference:url,googlechromereleases.blogspot.ca/2014/01/stable-channel-update.html; reference:url,trac.webkit.org/changeset/158676; classtype:attempted-user; sid:30252; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome NotifyInstanceWasDeleted object use after free attempt"; flow:to_client,established; file_data; content:"<object|20|"; content:"application/pdf",within 100; content:".addEventListener|28|",distance 0; content:"DOMContentLoaded",within 20,fast_pattern; content:".reload|28|",within 200; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:bugtraq,62752; reference:cve,2013-2912; classtype:attempted-user; sid:31594; rev:4; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome NotifyInstanceWasDeleted object use after free attempt"; flow:to_server,established; file_data; content:"<object|20|"; content:"application/pdf",within 100; content:".addEventListener|28|",distance 0; content:"DOMContentLoaded",within 20,fast_pattern; content:".reload|28|",within 200; metadata:policy max-detect-ips drop; service:smtp; reference:bugtraq,62752; reference:cve,2013-2912; classtype:attempted-user; sid:31595; rev:4; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome NotifyInstanceWasDeleted embed use after free attempt"; flow:to_client,established; file_data; content:"<embed|20|"; content:"application/pdf",within 100; content:".addEventListener|28|",distance 0; content:"DOMContentLoaded",within 20,fast_pattern; content:".reload|28|",within 200; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:bugtraq,62752; reference:cve,2013-2912; classtype:attempted-user; sid:31596; rev:4; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome NotifyInstanceWasDeleted embed use after free attempt"; flow:to_server,established; file_data; content:"<embed|20|"; content:"application/pdf",within 100; content:".addEventListener|28|",distance 0; content:"DOMContentLoaded",within 20,fast_pattern; content:".reload|28|",within 200; metadata:policy max-detect-ips drop; service:smtp; reference:bugtraq,62752; reference:cve,2013-2912; classtype:attempted-user; sid:31597; rev:4; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome NotifyInstanceWasDeleted object use after free attempt"; flow:to_server,established; file_data; content:"<object ",nocase; content:"application/pdf",within 125,nocase; content:".addEventListener",nocase; content:".innerHTML",nocase; content:".reload(",nocase; content:"fromCharCode",fast_pattern,nocase; pcre:"/\.innerHTML\s*?\x3d\s*?[\x22\x27]\s*?[\x22\x27]/smi"; metadata:policy max-detect-ips drop; service:smtp; reference:bugtraq,62752; reference:cve,2013-2912; classtype:attempted-user; sid:31598; rev:4; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome NotifyInstanceWasDeleted embed use after free attempt"; flow:to_server,established; file_data; content:"<embed ",nocase; content:"application/pdf",within 125,nocase; content:".addEventListener",nocase; content:".innerHTML",nocase; content:".reload(",nocase; content:"fromCharCode",fast_pattern,nocase; pcre:"/\.innerHTML\s*?\x3d\s*?[\x22\x27]\s*?[\x22\x27]/smi"; metadata:policy max-detect-ips drop; service:smtp; reference:bugtraq,62752; reference:cve,2013-2912; classtype:attempted-user; sid:31599; rev:4; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Blink locationAttributeSetter use after free attempt"; flow:to_client,established; file_data; content:"if (i<50) document.getElementById(|22|iframeSpecial|22|).contentDocument.location = o",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:bugtraq,66243; reference:cve,2014-1713; reference:url,code.google.com/p/chromium/issues/detail?id=352374; classtype:attempted-user; sid:32319; rev:4; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome Blink locationAttributeSetter use after free attempt"; flow:to_server,established; file_data; content:"if (i<50) document.getElementById(|22|iframeSpecial|22|).contentDocument.location = o",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:bugtraq,66243; reference:cve,2014-1713; reference:url,code.google.com/p/chromium/issues/detail?id=352374; classtype:attempted-user; sid:32320; rev:4; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome NotifyInstanceWasDeleted embed use after free attempt"; flow:to_client,established; file_data; content:"<embed ",nocase; content:"application/pdf",within 125,nocase; content:".addEventListener",nocase; content:".innerHTML",nocase; content:".reload(",nocase; content:"fromCharCode",fast_pattern,nocase; pcre:"/\.innerHTML\s*?\x3d\s*?[\x22\x27]\s*?[\x22\x27]/smi"; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:bugtraq,62752; reference:cve,2013-2912; classtype:attempted-user; sid:33661; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome NotifyInstanceWasDeleted object use after free attempt"; flow:to_client,established; file_data; content:"<object ",nocase; content:"application/pdf",within 125,nocase; content:".addEventListener",nocase; content:".innerHTML",nocase; content:".reload(",nocase; content:"fromCharCode",fast_pattern,nocase; pcre:"/\.innerHTML\s*?\x3d\s*?[\x22\x27]\s*?[\x22\x27]/smi"; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:bugtraq,62752; reference:cve,2013-2912; classtype:attempted-user; sid:33662; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"BROWSER-CHROME Google Chrome Pepper Flash same-origin-policy bypass attempt"; flow:to_server,established; http_header; content:"X-Requested-With: ShockwaveFlash/",fast_pattern,nocase; content:"Referer: "; content:"Content-Type: multipart/form-data"; content:"User-Agent: "; content:"Chrome/",distance 0; metadata:policy max-detect-ips drop; service:http; reference:cve,2015-0337; classtype:misc-attack; sid:33962; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"BROWSER-CHROME Google Chrome XSSAuditor Policy ByPass command injection attempt"; flow:to_server,established; http_client_body; content:"%3Csvg%3E%",fast_pattern,nocase; content:"%3Cscript%3E"; pkt_data; pcre:"/(%2F|\/|\x2f)(%3c|\x3c|\<)/i"; metadata:policy max-detect-ips drop; service:http, ssl; reference:url,codereview.chromium.org/1187843005/; reference:url,vulnerable.info/browsers/bypassing-chromes-anti-xss-filter/; classtype:attempted-user; sid:35411; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"BROWSER-CHROME Google Chrome xssauditor policy bypass command injection attempt"; flow:to_server,established; http_uri; content:"<svg>",fast_pattern,nocase; content:"<script>"; content:"/<",distance 0; metadata:policy max-detect-ips drop; service:http, ssl; reference:url,codereview.chromium.org/1187843005/; reference:url,vulnerable.info/browsers/bypassing-chromes-anti-xss-filter/; classtype:attempted-user; sid:35412; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome MOTW pageSerializer HTML injection attempt"; flow:to_client,established; file_data; content:"<!--"; content:"saved from url=(",within 50,nocase; content:"--",within 50; content:"--",within 50; pcre:"/<!--[^>]+saved from url=\x28[^>\x20]+--[^>]+--/i"; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2015-6784; classtype:attempted-dos; sid:37310; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome MOTW pageSerializer HTML injection attempt"; flow:to_server,established; file_data; content:"<!--"; content:"saved from url=(",within 50,nocase; content:"--",within 50; content:"--",within 50; pcre:"/<!--[^>]+saved from url=\x28[^>\x20]+--[^>]+--/i"; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2015-6784; classtype:attempted-dos; sid:37311; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome same origin policy bypass attempt"; flow:to_client,established; file_data; content:"contentWindow.onunload",nocase; content:".src",within 75,nocase; content:"javascript|3A|",within 50,nocase; content:"<script>",within 75,nocase; content:"XMLHttpRequest",within 100,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2015-6768; classtype:policy-violation; sid:37325; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome PDF Viewer information disclosure attempt"; flow:to_client,established; file_data; content:"document.createElement",nocase; content:"embed",within 50,nocase; content:".type",within 50,nocase; content:"application/x-google-chrome-pdf",within 60,nocase; content:"addEventListener",within 200,nocase; content:".postMessage",within 200,nocase; content:"event.data.selectedText",within 200,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2015-1302; reference:url,code.google.com/p/chromium/issues/detail?id=520422; classtype:misc-attack; sid:37326; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome PDF Viewer information disclosure attempt"; flow:to_server,established; file_data; content:"document.createElement",nocase; content:"embed",within 50,nocase; content:".type",within 50,nocase; content:"application/x-google-chrome-pdf",within 60,nocase; content:"addEventListener",within 200,nocase; content:".postMessage",within 200,nocase; content:"event.data.selectedText",within 200,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2015-1302; reference:url,code.google.com/p/chromium/issues/detail?id=520422; classtype:misc-attack; sid:37327; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Blink ImageBitmap integer overflow attempt"; flow:to_client,established; file_data; content:"createImageData"; content:"createImageBitmap",fast_pattern,nocase; pcre:"/createImageBitmap\x28[^\x29]*?(\d{5}|0x\d{4})/s"; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2016-5182; classtype:attempted-admin; sid:43117; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome Blink ImageBitmap integer overflow attempt"; flow:to_server,established; file_data; content:"createImageData"; content:"createImageBitmap",fast_pattern,nocase; pcre:"/createImageBitmap\x28[^\x29]*?(\d{5}|0x\d{4})/s"; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2016-5182; classtype:attempted-admin; sid:43118; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome V8 engine integer overflow attempt"; flow:to_client,established; file_data; content:".getImageData",fast_pattern,nocase; content:".__proto__"; content:".length"; content:"Array"; content:".concat("; isdataat:1000,relative; content:!")",within 1000; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:url,securityfocus.com/bid/36149/info; classtype:attempted-admin; sid:43955; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome V8 engine integer overflow attempt"; flow:to_server,established; file_data; content:".getImageData",fast_pattern,nocase; content:".__proto__"; content:".length"; content:"Array"; content:".concat("; isdataat:1000,relative; content:!")",within 1000; metadata:policy max-detect-ips drop; service:smtp; reference:url,securityfocus.com/bid/36149/info; classtype:attempted-admin; sid:43956; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome Blink ImageBitmap integer overflow attempt"; flow:to_server,established; file_data; content:"imgData.data[i] = 0xFF|3B|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2016-5182; classtype:attempted-admin; sid:45760; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Blink ImageBitmap integer overflow attempt"; flow:to_client,established; file_data; content:"imageData.data[i] = 0x41|3B|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2016-5182; classtype:attempted-admin; sid:45761; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Blink ImageBitmap integer overflow attempt"; flow:to_client,established; file_data; content:"imgData.data[i] = 0x41|3B|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2016-5182; classtype:attempted-admin; sid:45762; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Blink ImageBitmap integer overflow attempt"; flow:to_client,established; file_data; content:"imgData.data[i] = 0xFF|3B|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2016-5182; classtype:attempted-admin; sid:45763; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome Blink ImageBitmap integer overflow attempt"; flow:to_server,established; file_data; content:"imgData.data[i] = 0x41|3B|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2016-5182; classtype:attempted-admin; sid:45764; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome Blink ImageBitmap integer overflow attempt"; flow:to_server,established; file_data; content:"imageData.data[i] = 0x41|3B|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2016-5182; classtype:attempted-admin; sid:45765; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome Blink ImageBitmap integer overflow attempt"; flow:to_server,established; file_data; content:"imageData.data[i] = 0xFF|3B|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2016-5182; classtype:attempted-admin; sid:45766; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Blink ImageBitmap integer overflow attempt"; flow:to_client,established; file_data; content:"imageData.data[i] = 0xFF|3B|",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2016-5182; classtype:attempted-admin; sid:45767; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome Crankshaft type confusion attempt"; flow:to_server,established; file_data; content:"function carry_me_plz(arr,obj)",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2017-5070; classtype:attempted-user; sid:46975; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Crankshaft type confusion attempt"; flow:to_client,established; file_data; content:"function carry_me_plz(arr,obj)",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2017-5070; classtype:attempted-user; sid:46976; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Crankshaft type confusion attempt"; flow:to_client,established; file_data; content:"() {eval(|27|var"; content:"[i][0] =",distance 0; content:"e-311|3B|",within 75; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2017-5070; classtype:attempted-user; sid:46977; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome Crankshaft type confusion attempt"; flow:to_server,established; file_data; content:"() {eval(|27|var"; content:"[i][0] =",distance 0; content:"e-311|3B|",within 75; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2017-5070; classtype:attempted-user; sid:46978; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome V8 __defineGetter__ memory corruption attempt"; flow:to_client,established; file_data; content:"new "; content:"Array",within 25; content:"__defineGetter__(",distance 0; content:"return 0xffff",distance 0,fast_pattern,nocase; content:"new "; content:"Array",within 25; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2014-1705; classtype:attempted-user; sid:47018; rev:3; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome V8 __defineGetter__ memory corruption attempt"; flow:to_server,established; file_data; content:"new "; content:"Array",within 25; content:"__defineGetter__(",distance 0; content:"return 0xffff",distance 0,fast_pattern,nocase; content:"new "; content:"Array",within 25; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2014-1705; classtype:attempted-user; sid:47019; rev:3; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome FileReader use after free attempt"; flow:to_server,established; file_data; content:"FileReader|28|",nocase; content:"Blob|28|",within 200,fast_pattern,nocase; content:".result",within 300,nocase; content:"readAsArrayBuffer|28|",within 200,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:bugtraq,107213; reference:cve,2019-5786; reference:url,chromium-review.googlesource.com/c/chromium/src/+/1495209; classtype:attempted-user; sid:49360; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome FileReader use after free attempt"; flow:to_client,established; file_data; content:"FileReader|28|",nocase; content:"Blob|28|",within 200,fast_pattern,nocase; content:".result",within 200,nocase; content:"readAsArrayBuffer|28|",within 200,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:bugtraq,107213; reference:cve,2019-5786; reference:url,chromium-review.googlesource.com/c/chromium/src/+/1495209; classtype:attempted-user; sid:49361; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome V8 engine object instantiation heap corruption attempt"; flow:to_client,established; file_data; content:".repeat(0x3fffe-8)}",fast_pattern,nocase; content:"eval(`(function "; content:"extends Object {",distance 0; content:"(i-1) {",distance 0; content:".repeat(0x40000-8)}",distance 0; content:"(0x7ff))()|3B|",distance 0; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2018-6065; classtype:attempted-user; sid:51427; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome V8 engine object instantiation heap corruption attempt"; flow:to_server,established; file_data; content:".repeat(0x3fffe-8)}",fast_pattern,nocase; content:"eval(`(function "; content:"extends Object {",distance 0; content:"(i-1) {",distance 0; content:".repeat(0x40000-8)}",distance 0; content:"(0x7ff))()|3B|",distance 0; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2018-6065; classtype:attempted-user; sid:51428; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome blink webaudio module use after free attempt"; flow:to_client,established; file_data; content:"[144,144,144,144,101,72,139,4,37,48,0,0,0,72,139,96,8,72,129,236,8,16,0,0,144,144,144,144",fast_pattern,nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2019-13720; reference:url,chromereleases.googleblog.com/2019/10/stable-channel-update-for-desktop_31.html; classtype:attempted-user; sid:52068; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome blink webaudio module use after free attempt"; flow:to_server,established; file_data; content:"[144,144,144,144,101,72,139,4,37,48,0,0,0,72,139,96,8,72,129,236,8,16,0,0,144,144,144,144",fast_pattern,nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2019-13720; reference:url,chromereleases.googleblog.com/2019/10/stable-channel-update-for-desktop_31.html; classtype:attempted-user; sid:52069; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome Javascript V8 Array.indexOf information leak attempt"; flow:to_server,established; file_data; content:"Array.prototype.indexOf.call",fast_pattern,nocase; content:"Symbol.toPrimitive",nocase; content:"ArrayBufferNeuter",within 100,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2017-5040; reference:url,bugs.chromium.org/p/chromium/issues/detail?id=691323; classtype:attempted-user; sid:52248; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Javascript V8 Array.indexOf information leak attempt"; flow:to_client,established; file_data; content:"Array.prototype.indexOf.call",fast_pattern,nocase; content:"Symbol.toPrimitive",nocase; content:"ArrayBufferNeuter",within 100,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2017-5040; reference:url,bugs.chromium.org/p/chromium/issues/detail?id=691323; classtype:attempted-user; sid:52249; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Javascript V8 Array.includes information leak attempt"; flow:to_client,established; file_data; content:"Array.prototype.includes.call",fast_pattern,nocase; content:"Symbol.toPrimitive",nocase; content:"ArrayBufferNeuter",within 100,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2017-5040; reference:url,bugs.chromium.org/p/chromium/issues/detail?id=691323; classtype:attempted-user; sid:52250; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome Javascript V8 Array.includes information leak attempt"; flow:to_server,established; file_data; content:"Array.prototype.includes.call",fast_pattern,nocase; content:"Symbol.toPrimitive",nocase; content:"ArrayBufferNeuter",within 100,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2017-5040; reference:url,bugs.chromium.org/p/chromium/issues/detail?id=691323; classtype:attempted-user; sid:52251; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome V8 JavaScript Engine memory corruption attempt"; flow:to_client,established; file_data; content:"%OptimizeFunctionOnNextCall(",fast_pattern,nocase; content:"function"; content:"assertEquals("; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2017-5115; classtype:attempted-user; sid:52317; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome V8 JavaScript Engine memory corruption attempt"; flow:to_server,established; file_data; content:"%OptimizeFunctionOnNextCall(",fast_pattern,nocase; content:"function"; content:"assertEquals("; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2017-5115; classtype:attempted-user; sid:52318; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome V8 engine memory corruption attempt"; flow:to_client,established; file_data; content:"Object.preventExtensions(",fast_pattern,nocase; content:"Object.seal("; content:"Object.seal(",within 60,distance 50; content:": Object|7D|",within 50; content:".__proto__",within 55; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:url,blog.exodusintel.com/2019/09/09/patch-gapping-chrome/; classtype:attempted-user; sid:52348; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome V8 engine memory corruption attempt"; flow:to_server,established; file_data; content:"Object.preventExtensions(",fast_pattern,nocase; content:"Object.seal("; content:"Object.seal(",within 60,distance 50; content:": Object|7D|",within 50; content:".__proto__",within 55; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:url,blog.exodusintel.com/2019/09/09/patch-gapping-chrome/; classtype:attempted-user; sid:52349; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME V8 JavaScript engine Out-of-Memory denial of service attempt"; flow:to_server,established; file_data; content:"String.prototype.toLowerCase.call"; content:"String.prototype.toLowerCase.call",within 300; content:"String.prototype.toLowerCase.call",within 700; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:url,bugs.chromium.org/p/chromium/issues/detail?id=917631; classtype:attempted-dos; sid:52400; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME V8 JavaScript engine Out-of-Memory denial of service attempt"; flow:to_client,established; file_data; content:"String.prototype.toLowerCase.call"; content:"String.prototype.toLowerCase.call",within 300; content:"String.prototype.toLowerCase.call",within 700; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:url,bugs.chromium.org/p/chromium/issues/detail?id=917631; classtype:attempted-dos; sid:52401; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome V8 AwaitedPromise memory corruption attempt"; flow:to_client,established; file_data; content:"async function*"; content:"delete this.then",fast_pattern,nocase; content:".return({"; content:"get then()",within 250; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2018-6106; reference:url,bugs.chromium.org/p/chromium/issues/detail?id=805729; classtype:attempted-user; sid:52503; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome V8 AwaitedPromise memory corruption attempt"; flow:to_server,established; file_data; content:"async function*"; content:"delete this.then",fast_pattern,nocase; content:".return({"; content:"get then()",within 250; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2018-6106; reference:url,bugs.chromium.org/p/chromium/issues/detail?id=805729; classtype:attempted-user; sid:52504; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google V8 engine type confusion attempt"; flow:to_client,established; file_data; content:"Object.entries(",fast_pattern,nocase; content:"__defineGetter__"; content:"delete",within 1500; content:".unshift("; content:".length",distance 0; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2018-6064; classtype:attempted-user; sid:52601; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google V8 engine type confusion attempt"; flow:to_server,established; file_data; content:"Object.entries(",fast_pattern,nocase; content:"__defineGetter__"; content:"delete",within 1500; content:".unshift("; content:".length",distance 0; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2018-6064; classtype:attempted-user; sid:52602; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome V8 FindSharedFunctionInfo out-of-bounds read attempt"; flow:to_server,established; file_data; content:"this.__defineGetter__(",fast_pattern; content:"(function",distance 0; content:"})())",distance 0; content:"=>",within 5; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2017-5071; classtype:attempted-user; sid:53145; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome V8 FindSharedFunctionInfo out-of-bounds read attempt"; flow:to_client,established; file_data; content:"this.__defineGetter__(",fast_pattern; content:"(function",distance 0; content:"})())",distance 0; content:"=>",within 5; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2017-5071; classtype:attempted-user; sid:53146; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome V8 Turbofan Array pop type confusion attempt"; flow:to_client,established; file_data; content:".pop"; content:"Reflect.construct",distance 0; content:"arguments",within 50; content:"new Proxy"; content:"Object",within 50; content:"get",within 50; content:"Object.prototype",distance 0; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2020-6418; reference:url,chromereleases.googleblog.com/2020/02/stable-channel-update-for-desktop_24.html; classtype:attempted-user; sid:53342; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome V8 Turbofan Array pop type confusion attempt"; flow:to_server,established; file_data; content:".pop"; content:"Reflect.construct",distance 0; content:"arguments",within 50; content:"new Proxy"; content:"Object",within 50; content:"get",within 50; content:"Object.prototype",distance 0; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2020-6418; reference:url,chromereleases.googleblog.com/2020/02/stable-channel-update-for-desktop_24.html; classtype:attempted-user; sid:53343; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome desktopMediaPickerController use after free attempt"; flow:to_client,established; file_data; content:"chrome.runtime.connect("; content:"name:",within 70; content:"chooseDesktopMedia",within 70,fast_pattern; content:".postMessage("; content:"method:",within 30; content:"chooseDesktopMedia",within 70; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2019-13767; reference:url,bugs.chromium.org/p/chromium/issues/detail?id=1031653; classtype:attempted-user; sid:53533; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome desktopMediaPickerController use after free attempt"; flow:to_server,established; file_data; content:"chrome.runtime.connect("; content:"name:",within 70; content:"chooseDesktopMedia",within 70,fast_pattern; content:".postMessage("; content:"method:",within 30; content:"chooseDesktopMedia",within 70; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2019-13767; reference:url,bugs.chromium.org/p/chromium/issues/detail?id=1031653; classtype:attempted-user; sid:53534; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome ObjectCreate type confusion attempt"; flow:to_client,established; file_data; content:"BigInt.prototype.i2f",fast_pattern,nocase; content:"Number.prototype.f2i"; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2018-17463; classtype:attempted-user; sid:53751; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome ObjectCreate type confusion attempt"; flow:to_server,established; file_data; content:"new Uint8Array([0xfc, 0x48, 0x83, 0xe4, 0xf0, 0xe8, 0xc0, 0x",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2018-17463; classtype:attempted-user; sid:53752; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome ObjectCreate type confusion attempt"; flow:to_client,established; file_data; content:"new Uint8Array([0xfc, 0x48, 0x83, 0xe4, 0xf0, 0xe8, 0xc0, 0x",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2018-17463; classtype:attempted-user; sid:53753; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome ObjectCreate type confusion attempt"; flow:to_server,established; file_data; content:"BigInt.prototype.i2f",fast_pattern,nocase; content:"Number.prototype.f2i"; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2018-17463; classtype:attempted-user; sid:53754; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chromium ImageCapture use after free attempt"; flow:to_client,established; file_data; content:"new media.mojom.VideoCaptureHostPtr()|3B|",fast_pattern,nocase; content:"new media.mojom.ImageCapturePtr()|3B|"; content:"new media.mojom.VideoCaptureObserverPtr()|3B|"; content:".getPhotoState("; content:".stop(",within 50; content:".start("; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2019-13687; classtype:attempted-user; sid:53844; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chromium ImageCapture use after free attempt"; flow:to_server,established; file_data; content:"new media.mojom.VideoCaptureHostPtr()|3B|",fast_pattern,nocase; content:"new media.mojom.ImageCapturePtr()|3B|"; content:"new media.mojom.VideoCaptureObserverPtr()|3B|"; content:".getPhotoState("; content:".stop(",within 50; content:".start("; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2019-13687; classtype:attempted-user; sid:53845; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chromium for Android AddInterface use after free attempt"; flow:to_client,established; file_data; content:"document.body.removeChild(iframe)",fast_pattern,nocase; content:"getRandomArbitrary(min, max)"; content:"document.body.appendChild(iframe)",within 75,distance 120; content:"deallocate_rfh(iframe)",within 70,distance 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2019-13686; classtype:attempted-user; sid:53942; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chromium for Android AddInterface use after free attempt"; flow:to_server,established; file_data; content:"document.body.removeChild(iframe)",fast_pattern,nocase; content:"getRandomArbitrary(min, max) {"; content:"document.body.appendChild(iframe)",within 85,distance 120; content:"deallocate_rfh(iframe) {",within 65,distance 10; content:"deallocate_rfh(frames[i])",within 70,distance 260; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2019-13686; classtype:attempted-user; sid:53943; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome Blink use-after-free attempt"; flow:to_server,established; file_data; content:"blink.mojom.MediaStreamType.DISPLAY_VIDEO_CAPTURE",fast_pattern,nocase; content:"new blink.mojom.MediaStreamDispatcherHostPtr("; content:"blink.mojom.MediaStreamDispatcherHost.name",within 85; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2019-13688; reference:url,chromereleases.googleblog.com/2019/09/stable-channel-update-for-desktop_18.html; classtype:attempted-user; sid:54497; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Blink use-after-free attempt"; flow:to_client,established; file_data; content:"blink.mojom.MediaStreamType.DISPLAY_VIDEO_CAPTURE",fast_pattern,nocase; content:"new blink.mojom.MediaStreamDispatcherHostPtr("; content:"blink.mojom.MediaStreamDispatcherHost.name",within 85; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2019-13688; reference:url,chromereleases.googleblog.com/2019/09/stable-channel-update-for-desktop_18.html; classtype:attempted-user; sid:54498; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome ReadableStream out of bounds read attempt"; flow:to_client,established; file_data; content:"new ReadableStream",fast_pattern,nocase; content:"document.createNodeIterator"; content:"NodeFilter.FILTER_ACCEPT"; content:".tee()"; content:"getReader()"; content:"Object.prototype.__defineGetter__"; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2020-6390; classtype:attempted-user; sid:54622; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome ReadableStream out of bounds read attempt"; flow:to_server,established; file_data; content:"new ReadableStream",fast_pattern,nocase; content:"document.createNodeIterator"; content:"NodeFilter.FILTER_ACCEPT"; content:".tee()"; content:"getReader()"; content:"Object.prototype.__defineGetter__"; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2020-6390; classtype:attempted-user; sid:54623; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome blink webaudio module use after free attempt"; flow:to_client,established; file_data; content:"new OfflineAudioContext(",fast_pattern,nocase; content:".createConvolver("; content:".onaudioprocess",distance 0; content:"getChannelData(",distance 0; content:".startRendering("; content:"null",within 50; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2019-13720; reference:url,chromereleases.googleblog.com/2019/10/stable-channel-update-for-desktop_31.html; classtype:attempted-user; sid:54624; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome blink webaudio module use after free attempt"; flow:to_server,established; file_data; content:"new OfflineAudioContext(",fast_pattern,nocase; content:".createConvolver("; content:".onaudioprocess",distance 0; content:"getChannelData(",distance 0; content:".startRendering("; content:"null",within 50; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2019-13720; reference:url,chromereleases.googleblog.com/2019/10/stable-channel-update-for-desktop_31.html; classtype:attempted-user; sid:54625; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome AudioArray memory corruption attempt"; flow:to_client,established; file_data; content:"new Uint8Array("; content:"new OfflineAudioContext(",distance 0; content:".decodeAudioData",distance 0; content:".buffer)|3B|",within 50; content:"createDelay(",within 250; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2020-6388; reference:url,chromereleases.googleblog.com/2020/02/stable-channel-update-for-desktop.html; classtype:attempted-user; sid:55809; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome AudioArray memory corruption attempt"; flow:to_server,established; file_data; content:"new Uint8Array("; content:"new OfflineAudioContext(",distance 0; content:".decodeAudioData",distance 0; content:".buffer)|3B|",within 50; content:"createDelay(",within 250; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2020-6388; reference:url,chromereleases.googleblog.com/2020/02/stable-channel-update-for-desktop.html; classtype:attempted-user; sid:55810; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome PNG in TTF parsing heap overflow attempt"; flow:to_client,established; flowbits:isset,file.ttf; file_data; content:"|89|PNG|0D 0A 1A 0A 00 00 00 0D|IHDR"; byte_test:4,>,0x7fff,4,relative; content:"|00|",within 1,distance 10; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2020-15999; reference:url,chromium.googlesource.com/chromium/src/third_party/freetype2.git/+/refs/heads/chromium/branch-heads/4240%5E%21/; classtype:attempted-user; sid:56130; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome PNG in TTF parsing heap overflow attempt"; flow:to_server,established; flowbits:isset,file.ttf; file_data; content:"|89|PNG|0D 0A 1A 0A 00 00 00 0D|IHDR"; byte_test:4,>,0x7fff,4,relative; content:"|00|",within 1,distance 10; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2020-15999; reference:url,chromium.googlesource.com/chromium/src/third_party/freetype2.git/+/refs/heads/chromium/branch-heads/4240%5E%21/; classtype:attempted-user; sid:56131; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome PNG in TTF parsing heap overflow attempt"; flow:to_client,established; flowbits:isset,file.ttf; file_data; content:"|89|PNG|0D 0A 1A 0A 00 00 00 0D|IHDR"; byte_test:4,>,0x7fff,0,relative; content:"|00|",within 1,distance 10; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2020-15999; reference:url,chromium.googlesource.com/chromium/src/third_party/freetype2.git/+/refs/heads/chromium/branch-heads/4240%5E%21/; classtype:attempted-user; sid:56132; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome PNG in TTF parsing heap overflow attempt"; flow:to_server,established; flowbits:isset,file.ttf; file_data; content:"|89|PNG|0D 0A 1A 0A 00 00 00 0D|IHDR"; byte_test:4,>,0x7fff,0,relative; content:"|00|",within 1,distance 10; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2020-15999; reference:url,chromium.googlesource.com/chromium/src/third_party/freetype2.git/+/refs/heads/chromium/branch-heads/4240%5E%21/; classtype:attempted-user; sid:56133; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Blink Renderer MediaElementEventListener memory corruption attempt"; flow:to_client,established; file_data; content:"new Audio"; content:"captureStream(",distance 0; content:"onaddtrack",distance 0; content:"=>",within 10; content:"getAudioTracks()[",within 75,fast_pattern; content:"onended",distance 0; content:"dispatchEvent(new Event",within 2000; content:"src"; content:"replace",within 25; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2020-6549; reference:url,crbug.com/1105426; classtype:attempted-user; sid:56437; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome Blink Renderer MediaElementEventListener memory corruption attempt"; flow:to_server,established; file_data; content:"new Audio"; content:"captureStream()",distance 0; content:"onaddtrack",distance 0; content:"=>",within 10; content:"getAudioTracks()[",within 50,fast_pattern; content:"onended",distance 0; content:"dispatchEvent(new Event",within 2000; content:"src"; content:"replace",within 25; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2020-6549; reference:url,crbug.com/1105426; classtype:attempted-user; sid:56438; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Microsoft Teams Electron framework command injection attempt"; flow:to_client,established; file_data; content:"msteams:"; content:"--browser-subprocess-path=",within 150,nocase; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2018-1000006; reference:url,electronjs.org/blog/protocol-handler-fix; classtype:attempted-user; sid:56449; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Microsoft Teams Electron framework command injection attempt"; flow:to_server,established; file_data; content:"msteams:"; content:"--browser-subprocess-path=",within 150,nocase; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2018-1000006; reference:url,electronjs.org/blog/protocol-handler-fix; classtype:attempted-user; sid:56450; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome WebXR component use after free attempt"; flow:to_client,established; file_data; content:"requestSession("; content:"session",distance 0; content:"=>",within 10; content:"onvisibilitychange",within 75,fast_pattern; content:"for(",distance 0; content:"reload()",distance 0; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2020-6551; classtype:attempted-user; sid:57365; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome WebXR component use after free attempt"; flow:to_server,established; file_data; content:"requestSession("; content:"session",distance 0; content:"=>",within 10; content:"onvisibilitychange",within 75,fast_pattern; content:"for(",distance 0; content:"reload()",distance 0; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2020-6551; classtype:attempted-user; sid:57366; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome WebAssembly memory corruption attempt"; flow:to_server,established; file_data; content:"new Worker(window.URL.createObjectUrl(",fast_pattern,nocase; content:"URL.createObjectURL"; content:"new Blob([new Uint8Array",within 50; content:"new AbortController",distance 0; content:"Object.defineProperty",distance 0; content:"get",distance 0; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2020-15994; reference:url,chromereleases.googleblog.com/2020/10/chrome-for-android-update_31.html; classtype:attempted-user; sid:57375; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome WebAssembly memory corruption attempt"; flow:to_client,established; file_data; content:"new Worker(window.URL.createObjectUrl(",fast_pattern,nocase; content:"URL.createObjectURL"; content:"new Blob([new Uint8Array",within 50; content:"new AbortController",distance 0; content:"Object.defineProperty",distance 0; content:"get",distance 0; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2020-15994; reference:url,chromereleases.googleblog.com/2020/10/chrome-for-android-update_31.html; classtype:attempted-user; sid:57376; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome V8 engine integer overflow attempt"; flow:to_client,established; file_data; content:"new Uint32Array([2**31])",fast_pattern,nocase; content:"^"; content:"1",distance 0; pcre:"/\x5b\s*?0\s*?\x5d\s*?\x5e\s*?0\s*?\x29\s*?\x2b\s*?1/"; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2021-21220; reference:url,chromereleases.googleblog.com/2021/04/stable-channel-update-for-desktop.html; classtype:attempted-user; sid:57420; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome V8 engine integer overflow attempt"; flow:to_server,established; file_data; content:"new Uint32Array([2**31])",fast_pattern,nocase; content:"^"; content:"1",distance 0; pcre:"/\x5b\s*?0\s*?\x5d\s*?\x5e\s*?0\s*?\x29\s*?\x2b\s*?1/"; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2021-21220; reference:url,chromereleases.googleblog.com/2021/04/stable-channel-update-for-desktop.html; classtype:attempted-user; sid:57421; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome V8 JavaScript Engine memory corruption attempt"; flow:to_client,established; file_data; content:"let",nocase; content:"={}",within 20; content:"%DebugPrint(",within 50; content:"%NeverOptimizeFunction(",within 50,fast_pattern; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2020-16009; reference:url,bugs.chromium.org/p/chromium/issues/detail?id=1143772; classtype:attempted-user; sid:57423; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome V8 JavaScript Engine memory corruption attempt"; flow:to_server,established; file_data; content:"let",nocase; content:"={}",within 20; content:"%DebugPrint(",within 50; content:"%NeverOptimizeFunction(",within 50,fast_pattern; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2020-16009; reference:url,bugs.chromium.org/p/chromium/issues/detail?id=1143772; classtype:attempted-user; sid:57424; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome Math.max memory corruption attempt"; flow:to_client,established; file_data; content:"-1"; content:"if",within 75; content:"0xFFFFFFFF",within 40,nocase; content:"Math.max(",within 75; pcre:"/=\s*?-1.{0,75}if.{0,25}=\s*?0xFFFFFFFF.{0,75}Math.max\x28/is"; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:url,chromium-review.googlesource.com/c/v8/v8/+/2817791; classtype:attempted-user; sid:57429; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome Math.max memory corruption attempt"; flow:to_server,established; file_data; content:"-1"; content:"if",within 75; content:"0xFFFFFFFF",within 40,nocase; content:"Math.max(",within 75; pcre:"/=\s*?-1.{0,75}if.{0,25}=\s*?0xFFFFFFFF.{0,75}Math.max\x28/is"; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:url,chromium-review.googlesource.com/c/v8/v8/+/2817791; classtype:attempted-user; sid:57430; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome V8 OnServiceConnectionError memory corruption attempt"; flow:to_client,established; file_data; content:"navigator.usb.getDevices()",fast_pattern,nocase; content:"location.hash"; content:"document.onclick",within 100; content:"open(location.href",within 100; content:"close()",distance 0; content:"Array.prototype.__defineGetter__"; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2020-6541; reference:url,chromereleases.googleblog.com/2020/07/stable-channel-update-for-desktop_27.html; classtype:attempted-user; sid:57440; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome V8 OnServiceConnectionError memory corruption attempt"; flow:to_server,established; file_data; content:"navigator.usb.getDevices()",fast_pattern,nocase; content:"location.hash"; content:"document.onclick",within 100; content:"open(location.href",within 100; content:"close()",distance 0; content:"Array.prototype.__defineGetter__"; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2020-6541; reference:url,chromereleases.googleblog.com/2020/07/stable-channel-update-for-desktop_27.html; classtype:attempted-user; sid:57441; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"BROWSER-CHROME Google Chrome JavaScript engine use after free attempt"; flow:to_client,established; file_data; content:"setTimeout"; content:"location.href.replace"; content:".contentWindow"; content:".databases()",distance 0; content:".Array.prototype|3B|",distance 0,fast_pattern; content:".__defineGetter__",distance 0; content:"delete",distance 0; content:".then|3B|",within 50; metadata:policy max-detect-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2020-6550; classtype:attempted-user; sid:57446; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-CHROME Google Chrome JavaScript engine use after free attempt"; flow:to_server,established; file_data; content:"setTimeout"; content:"location.href.replace"; content:".contentWindow"; content:".databases()",distance 0; content:".Array.prototype|3B|",distance 0,fast_pattern; content:".__defineGetter__",distance 0; content:"delete",distance 0; content:".then|3B|",within 50; metadata:policy max-detect-ips drop; service:smtp; reference:cve,2020-6550; classtype:attempted-user; sid:57447; rev:1; )
